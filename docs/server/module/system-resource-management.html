<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>System Resource Management | Turms Documentation</title>
    <meta name="description" content="A VitePress site">
    <link rel="preload stylesheet" href="/docs/assets/style.69f6298a.css" as="style">
    
    <script type="module" src="/docs/assets/app.b51ba44f.js"></script>
    <link rel="preload" href="/docs/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/docs/assets/chunks/framework.0882ee08.js">
    <link rel="modulepreload" href="/docs/assets/chunks/theme.a0e6ceae.js">
    <link rel="modulepreload" href="/docs/assets/chunks/mermaid.core.9a5529a8.js">
    <link rel="modulepreload" href="/docs/assets/server_module_system-resource-management.md.14cf6b55.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5a346dfe><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5a346dfe data-v-ae24b3ad><div class="VPNavBar has-sidebar" data-v-ae24b3ad data-v-a0fd61f4><div class="container" data-v-a0fd61f4><div class="title" data-v-a0fd61f4><div class="VPNavBarTitle has-sidebar" data-v-a0fd61f4 data-v-86d1bed8><a class="title" href="/docs/" data-v-86d1bed8><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://raw.githubusercontent.com/turms-im/assets/master/logo/pegion.svg" alt data-v-8426fc1a><!--]--><!--[-->Turms Documentation<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a0fd61f4><div class="curtain" data-v-a0fd61f4></div><div class="content-body" data-v-a0fd61f4><!--[--><!--]--><div class="VPNavBarSearch search" data-v-a0fd61f4><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><div class="VPFlyout VPNavBarTranslations translations" data-v-a0fd61f4 data-v-74abcbb9 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-9c007e85><span class="text" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="option-icon" data-v-9c007e85><path d="M0 0h24v24H0z" fill="none"></path><path d=" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z " class="css-c4d79v"></path></svg><!----><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><div class="items" data-v-74abcbb9><p class="title" data-v-74abcbb9>English</p><!--[--><div class="VPMenuLink" data-v-74abcbb9 data-v-43f1e123><a class="VPLink link" href="/docs/zh-CN/server/module/system-resource-management.html" data-v-43f1e123><!--[-->简体中文<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-a0fd61f4 data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-e6aabb21 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a0fd61f4 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/turms-im/turms" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a0fd61f4 data-v-40855f84 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9c007e85><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><div class="group translations" data-v-40855f84><p class="trans-title" data-v-40855f84>English</p><!--[--><div class="VPMenuLink" data-v-40855f84 data-v-43f1e123><a class="VPLink link" href="/docs/zh-CN/server/module/system-resource-management.html" data-v-43f1e123><!--[-->简体中文<!--]--></a></div><!--]--></div><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-40855f84><div class="item social-links" data-v-40855f84><div class="VPSocialLinks social-links-list" data-v-40855f84 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/turms-im/turms" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a0fd61f4 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-5a346dfe data-v-79c8c1df><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-79c8c1df><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-79c8c1df><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-79c8c1df>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-79c8c1df data-v-1c15a60a><button data-v-1c15a60a>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-5a346dfe data-v-b00e2fdd><div class="curtain" data-v-b00e2fdd></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b00e2fdd><span class="visually-hidden" id="sidebar-aria-label" data-v-b00e2fdd> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0" data-v-b00e2fdd data-v-e31bd47b><!----><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/index.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Introduction</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/community/index.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Community FAQ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>Business Features</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e31bd47b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e31bd47b><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/feature/index.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Business Features</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/feature/simultaneous-login.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Simultaneous Login</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/feature/user.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>User-related Features</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/feature/group.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Group-related Features</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/feature/message.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Message-related Features</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>Design</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e31bd47b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e31bd47b><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/design/architecture.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Architecture Design</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/design/schema.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Collection Schema Design</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/design/status-aware.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Status Awareness</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 collapsible has-active" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>Server Guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e31bd47b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e31bd47b><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e31bd47b><!--[--><section class="VPSidebarItem level-1" data-v-e31bd47b data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h3 class="text" data-v-e31bd47b>Deployment</h3><!----></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/deployment/getting-started.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Build and Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/deployment/distribution.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Distribution</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/deployment/config.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Configuration</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-e31bd47b data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h3 class="text" data-v-e31bd47b>Development</h3><!----></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/development/redevelopment.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>About Secondary Development</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/development/rules.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Basic Development Rules</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/development/plugin.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Custom Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/development/code.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Source Code</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/development/testing.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Testing</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 has-active" data-v-e31bd47b data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h3 class="text" data-v-e31bd47b>Main Modules</h3><!----></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/identity-access-management.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Identity and Access Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/cluster.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Cluster Design and Implementation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/system-resource-management.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>System Resource Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/observability.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Observability</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/security.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Security</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/xmpp.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>XMPP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/storage.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Storage Service</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/chatbot.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Chatbot</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/anti-spam.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Content Moderation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/server/module/data-analytics.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Data Analysis</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>Client Guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e31bd47b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e31bd47b><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/quick-start.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Quick Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/requirements.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Version Requirements</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/api.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/session.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Session Lifecycle</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/metrics.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Metrics</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/communication-protocol.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Communication Protocol Used Between Client and Server</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/turms-client-js.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>turms-client-js Shared Context</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/client/turms-chat-demo.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Turms Chat Demo</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0" data-v-b00e2fdd data-v-e31bd47b><!----><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/turms-admin.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>turms-admin</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 collapsible collapsed" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>Reference</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e31bd47b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e31bd47b><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/reference/admin-api.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Admin API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/docs/reference/status-code.html" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>Status Code</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5a346dfe data-v-669faec9><div class="VPDoc has-sidebar has-aside" data-v-669faec9 data-v-6b87e69f><!--[--><!--]--><div class="container" data-v-6b87e69f><div class="aside" data-v-6b87e69f><div class="aside-curtain" data-v-6b87e69f></div><div class="aside-container" data-v-6b87e69f><div class="aside-content" data-v-6b87e69f><div class="VPDocAside" data-v-6b87e69f data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-d330b1bb><div class="content" data-v-d330b1bb><div class="outline-marker" data-v-d330b1bb></div><div class="outline-title" role="heading" aria-level="2" data-v-d330b1bb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d330b1bb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d330b1bb> Table of Contents for current page </span><ul class="root" data-v-d330b1bb data-v-d0ee3533><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6b87e69f><div class="content-container" data-v-6b87e69f><!--[--><!--]--><!----><main class="main" data-v-6b87e69f><div style="position:relative;" class="vp-doc _docs_server_module_system-resource-management" data-v-6b87e69f><div><h1 id="system-resource-management" tabindex="-1">System Resource Management <a class="header-anchor" href="#system-resource-management" aria-label="Permalink to &quot;System Resource Management&quot;">​</a></h1><p>The importance of memory and CPU resources to the server is self-evident. Each module of Turms uses memory and CPU to the extreme. For details, please refer to the documents and codes implemented by each module. On the other hand, in order to ensure the normal operation of the server, it also provides a set of health detection mechanism internally. This mechanism cooperates with the &quot;denial of service&quot; mechanism of the upper layer to do its best to ensure the normal operation of the server.</p><p>Turms provides a system resource monitoring configuration class: <code>im.turms.server.common.infra.property.env.common.healthcheck.HealthCheckProperties</code>, to allow users to configure available memory usage and CPU usage. The <code>HealthCheckManager</code> on the Turms server will continuously detect the available physical memory and CPU usage. If it detects that the available physical memory is too low or the CPU usage is too high, it will:</p><ul><li>Mark the <code>isHealthy</code> information in the service registry as <code>false</code>. Since the RPC sender will only select the RPC response server from the server whose <code>isHealthy</code> is <code>true</code>, it can achieve a similar back pressure effect</li><li>Refusal to provide external services. Specifically: if it is the turms-gateway server, refuse to establish a new session and process user requests; if it is the turms-service server, refuse to process the RPC request sent by the turms-gateway server (note: even in &quot;Unhealthy&quot; status, turms-service will still provide services for the admin API)</li></ul><h2 id="memory-management" tabindex="-1">Memory management <a class="header-anchor" href="#memory-management" aria-label="Permalink to &quot;Memory management&quot;">​</a></h2><h3 id="jvm-basic-memory-knowledge" tabindex="-1">JVM basic memory knowledge <a class="header-anchor" href="#jvm-basic-memory-knowledge" aria-label="Permalink to &quot;JVM basic memory knowledge&quot;">​</a></h3><p>The memory area of the JVM HotSpot virtual machine can be divided into:</p><ul><li><p>Heap Memory: Eden area, Survivor area, Old Generation (Old Generation)</p></li><li><p>Non-heap Memory (Non-heap Memory)</p><ul><li>Direct memory (Direct Memory): Direct Buffer Pool</li><li>JVM internal memory (JVM Specific Memory): local method stack, metaspace, Code Cache, etc.</li></ul><p>Special attention: <code>NonHeapMemory</code> obtained by the function <code>java.lang.management.MemoryMXBean#getNonHeapMemoryUsage</code> does not include <code>Direct Buffer Pool</code> (direct memory buffer pool). Specifically, the memory space referred to by this function in JDK 21 is:</p><ul><li>CodeHeap &#39;non-nmethods&#39;</li><li>CodeHeap &#39;non-profiled nmethods&#39;</li><li>CodeHeap &#39;profiled nmethods&#39;</li><li>Compressed Class Space</li><li>Metaspace</li></ul></li></ul><p>Reference document: <a href="https://docs.oracle.com/en/java/javase/21/troubleshoot/diagnostic-tools.html#GUID-FB0581EA-2F91-4093-B2FA-46687F7AB081" target="_blank" rel="noreferrer">How to Monitor VM Internal Memory</a></p><h3 id="use-of-managed-memory" tabindex="-1">Use of Managed Memory <a class="header-anchor" href="#use-of-managed-memory" aria-label="Permalink to &quot;Use of Managed Memory&quot;">​</a></h3><p>The controllable memory of the Turms server refers to the two areas of <code>heap memory (Heap Memory)</code> and <code>direct memory (Direct Memory)</code>.</p><h4 id="heap-memory" tabindex="-1">Heap memory <a class="header-anchor" href="#heap-memory" aria-label="Permalink to &quot;Heap memory&quot;">​</a></h4><h5 id="practical-significance" tabindex="-1">Practical significance <a class="header-anchor" href="#practical-significance" aria-label="Permalink to &quot;Practical significance&quot;">​</a></h5><p>The practical significance of heap memory is relatively easy to understand, which is to configure as large a heap memory as possible to reduce the number of GC and the occurrence of <code>stop-the-world</code> events.</p><h5 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h5><p>The default heap configuration of the JVM is as follows:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-XX:MaxRAMPercentage=75</span></span>
<span class="line"><span style="color:#e1e4e8;">-XX:InitialRAMPercentage=75</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-XX:MaxRAMPercentage=75</span></span>
<span class="line"><span style="color:#24292e;">-XX:InitialRAMPercentage=75</span></span></code></pre></div><p>in:</p><ul><li><code>InitialRAMPercentage</code> and <code>MaxRAMPercentage</code> specify the size of the memory that needs to be reserved, but a page fault will still occur when the Turms server accesses this memory area. Although the JVM can directly convert the reserved memory into committed memory by configuring <code>AlwaysPreTouch</code> to avoid page fault exceptions on the server side during runtime. But because it is difficult for the server to monitor the actual used heap memory after enabling this option, it is not recommended to add this configuration at present.</li><li><code>InitialRAMPercentage</code> and <code>MaxRAMPercentage</code> are set to the same value mainly to ensure the continuity of the memory as much as possible, and avoid repeated GC and <code>stop-the-world</code> operations on the server due to memory expansion and shrinkage.</li><li>The heap memory is not configured to a value close to 100%. This is to give the remaining physical memory to the JVM&#39;s own off-heap memory (such as the largest direct memory, CodeCache, Metaspace, etc.), the system kernel (such as maintaining the TCP connection time buffer) and sidecar services (such as: log collection service).</li></ul><p>In addition, it is recommended not to allocate more than 32GB of memory to the Turms server in the production environment. because:</p><ul><li>Turn on the pointer compression technology of the JVM to reduce unnecessary memory usage</li><li>Avoid a single server carrying too much load, slow down the shocking group effect during shutdown, and improve user experience</li></ul><h4 id="direct-memory" tabindex="-1">Direct Memory <a class="header-anchor" href="#direct-memory" aria-label="Permalink to &quot;Direct Memory&quot;">​</a></h4><p>All <code>direct memory</code> described below are allocated by <code>PooledByteBufAllocator.DEFAULT</code> in the actual code, that is, they are all direct memory cached and managed by Netty.</p><h5 id="practical-significance-1" tabindex="-1">Practical significance <a class="header-anchor" href="#practical-significance-1" aria-label="Permalink to &quot;Practical significance&quot;">​</a></h5><p>The upper limit of direct memory capacity affects the peak value of client requests and admin API requests that the Turms server can handle at the same time</p><h5 id="main-users" tabindex="-1">Main users <a class="header-anchor" href="#main-users" aria-label="Permalink to &quot;Main users&quot;">​</a></h5><ul><li>Network I/O operations. For example, based on Netty: the third party relies on drivers such as <code>mongo-driver-java</code> and <code>Lettuce</code>; the Turms server itself implements the client-oriented TCP/HTTP server.</li><li>Log printing. The log printing developed by Turms directly writes Java basic data into the direct memory block, and then writes it into the file descriptor.</li></ul><p>In other words, basically all memory areas that need to be accessed by the system kernel, we use direct memory directly to avoid meaningless heap memory copies.</p><p>Note: In the Linux system, the direct memory used by Turms is still in the user space, so when writing the direct memory to the device (such as network card and hard disk), it still needs to be copied twice from the user space to the kernel space and from the kernel space to the device , and these two copy operations cannot be avoided by the upper server.</p><h5 id="life-cycle" tabindex="-1">life cycle <a class="header-anchor" href="#life-cycle" aria-label="Permalink to &quot;life cycle&quot;">​</a></h5><p>Because in the Turms server, the life cycle of direct memory is highly consistent with the life cycle of client requests and admin API requests, a piece of direct memory usually only exists in part or all of the life cycle of a request. Specifically, its life cycle is roughly as follows:</p><ul><li><p>The life cycle of a request begins when Netty cuts the TCP byte stream. Netty cuts the TCP byte stream according to the varint encoded header (the length of the Payload represented by its value), and when this memory is cut When it comes out (note: there is no memory copy here), the life cycle of this piece of direct memory representing the request begins.</p></li><li><p>After the Turms server parses this memory into a specific request model, Turms will determine whether this type of request needs to use its own direct memory. If the processing logic of the request does not need to use this memory, the memory will be immediately reclaimed back to Netty&#39;s memory cache pool. Otherwise, requests such as &quot;forwarding user messages&quot; need to use this memory, and this memory will not be reclaimed immediately. Turms will then perform business logic processing on the request.</p></li><li><p>In the process of business processing, other network I/O operations (such as sending requests to MongoDB/Redis) or log printing operations may be involved. These two types of operations need to take out new direct from the memory buffer pool managed by Netty Memory block for MongoDB/Redis client request encoding and response decoding operations, or log printing operations.</p></li><li><p>After the Turms server finally flushes the direct memory of the request response to the network card, in addition to the direct memory representing the log record, other direct memory involved in the process will also be recycled.</p><p>The only exception is: if the direct memory of a request needs to be forwarded to multiple clients, Turms will use the reference counter to separate the life cycle of the request from the life cycle of the direct memory to ensure that the same piece of direct memory Forwarded to multiple clients to avoid memory copies.</p><p>Notice:</p><ol><li>The <code>direct memory reclamation</code> mentioned above does not reclaim the memory to the system, but reclaims it back to the memory pool managed by Netty, and the memory will not be actually released at this time.</li><li>Direct memory is mainly through: When Pooled ByteBuf is <code>release</code>, Netty will detect whether the Chunk it belongs to is idle (0% usage). If yes, the memory is actually freed by the function <code>io.netty.buffer.PoolArena#destroyChunk</code>.</li></ol></li></ul><p>Due to the existence of this life cycle, the real usage rate of heap memory and direct memory is actually related. The increase in heap memory is mainly due to a series of logics processed by the Turms server after receiving client requests or admin API requests. In a process, the usage rate of direct memory increases because of request decoding and response encoding, network I/O operation encoding and decoding and log printing in the logic. When the life cycle of the request ends, both the heap memory and the direct memory can be reclaimed.</p><h3 id="memory-health-check" tabindex="-1">Memory health check <a class="header-anchor" href="#memory-health-check" aria-label="Permalink to &quot;Memory health check&quot;">​</a></h3><h4 id="configuration-1" tabindex="-1">Configuration <a class="header-anchor" href="#configuration-1" aria-label="Permalink to &quot;Configuration&quot;">​</a></h4><p>Configuration class: <code>im.turms.server.common.infra.property.env.common.healthcheck.MemoryHealthCheckProperties</code></p><p>As mentioned above, it is very difficult or even unrealistic for the operation and maintenance personnel to accurately estimate how much memory the server should use, especially the memory occupied by some key system kernels (such as TCP connections) changes dynamically, so <code>MemoryHealthCheckProperties</code> not only provides configurations such as <code>maxAvailableMemoryPercentage</code> and <code>maxAvailableDirectMemoryPercentage</code> that limit the upper limit of the memory that the Turms server can use, but also provides the configuration <code>minFreeSystemMemoryBytes</code>, which allows the Turms server to detect the available physical memory of the system in real time, and Do your best to reserve this memory.</p><h4 id="memory-monitoring-implementation-memoryhealthchecker" tabindex="-1">Memory monitoring implementation - MemoryHealthChecker <a class="header-anchor" href="#memory-monitoring-implementation-memoryhealthchecker" aria-label="Permalink to &quot;Memory monitoring implementation - MemoryHealthChecker&quot;">​</a></h4><p>effect:</p><ul><li>When it is detected that the system&#39;s physical memory is insufficient, notify the upper layer service to refuse to process user sessions and requests, so as to do its best to ensure that the physical memory will not be exhausted and avoid using Swap memory</li><li>If it is detected that the system has insufficient physical memory and the used heap memory exceeds <code>heapMemoryGcThresholdPercentage</code>, call <code>System.gc()</code> to suggest JVM to perform Full GC</li></ul><p>pay attention</p><ul><li>As mentioned above, the life cycle of the direct memory is highly consistent with the life cycle of the request, so even if <code>MemoryHealthChecker</code> detects that <code>the total memory used has exceeded XX</code>, it will not actively try to release the direct memory, but wait Netty&#39;s internal memory management mechanism releases it</li><li>In summary, although the Turms server will try its best not to run out of physical memory, for a large number of extremely sudden requests, the Turms server may still run out of physical memory, and Swap memory will be used at this time. If the Swap memory is closed by the system or the Swap memory is insufficient, the Turms server will directly throw an <code>OutOfMemoryError</code> exception. Therefore, we can use Swap memory as the last line of defense, so it is not recommended to turn off Swap memory in a production environment.</li></ul><h3 id="about-the-valhalla-project-codes-like-a-class-works-like-an-int" tabindex="-1">About the Valhalla project - Codes like a class, works like an int <a class="header-anchor" href="#about-the-valhalla-project-codes-like-a-class-works-like-an-int" aria-label="Permalink to &quot;About the Valhalla project - Codes like a class, works like an int&quot;">​</a></h3><p>The memory usage of Java has always been criticized by people. For example, the memory required by the object header stored by an Integer object (12 bytes in the case of a 64-bit system and the compressed pointer is turned on) is several times larger than the actual int data, and because Such design flaws lead to the need for some workarounds when programming. For example, when using <code>Integer</code> objects, the JVM will preferentially use the object cache in the <code>java.lang.Integer.IntegerCache</code> class. Compared with many C++ server projects (such as Nginx and Redis) that pursue performance optimization (even register-level optimization), due to Java&#39;s own design flaws and conservatism, Java&#39;s waste of memory makes people feel a little &quot;self-defeating&quot;. And what&#39;s worse: this spirit has also been transmitted to the entire Java ecosystem. By reading the source code, we can find that many well-known Java projects also have the attitude of &quot;the function can be used, the code is comfortable to write, and the performance is about the same. Anyway, the JVM will help the GC&quot;. Repeated memory copying (such as the most common <code>String</code> and <code>StringBuilder</code> are usually copied back and forth many times in practice, and the source code is shocking), only a very few projects such as Netty have the awareness of performance optimization and excellence. We have already explained this point in other chapters, so I won’t repeat it here.</p><p>The Valhalla project reconstructs the existing Java Object system. The original <code>Object</code> is called <code>IdentityObject</code> in the new Java system, and the <code>Object</code> under the new system has become the parent class of <code>IdentityObject</code> and <code>ValueObject</code> (note: the Valhalla team has not yet finalized, so the concept may not yet be finalized. will change), the two are somewhat similar to C#&#39;s <code>Reference types</code> and <code>Value types</code>. Among them, <code>ValueObject</code> is divided into two categories, namely <code>primitive class</code> and <code>value class</code>. <code>primitive class</code> allows developers to customize data structures that are as efficient as the eight traditional Java basic types, without object headers, without pointer lookup, stack allocation, and naturally without GC. At the same time, these classes can also be declared fields and define functions. The traditional eight basic types of Java will also be redesigned based on the new object system, such as <code>int</code> such <code>primitive type</code> will become <code>primitive class</code> (<code>primitive class</code> is a type of <code>value class</code>, its value cannot be <code>null</code>), and its <code>wrapper class (Wrapper Class)</code> <code>Integer</code> and <code>int.ref</code> that may be supported will become <code>value class</code> (value can be <code>null</code>), so the future will not There will be the concept of <code>wrapper class</code>.</p><p>For example, the primitive instance object of the class <code>primitive class Point { private double x; private double y; }</code> only needs to occupy 2 double bytes, that is, 16 bytes, and no object header is required.</p><p>After the Valhalla project releases the Preview version, we will introduce <code>ValueObject</code> and transform code implementations such as DTO objects and various wrapper classes (such as <code>Date</code> and <code>ByteArrayWrapper</code>) to greatly reduce memory overhead and the number of objects and speed up GC speed. And because we have been waiting for this project for several years and are very familiar with its design, we can complete the fitting and testing work within a week. This is also the only feature that we will green light for the <code>Preview</code> feature.</p><p>Replenish:</p><ul><li><p>In fact, the development history of Java also confirms what we have talked about &quot;<a href="https://turms-im.github.io/docs/design/schema#%E5%8A%9F%E8%83%BD%E4%B8%B0%E5%AF%8C%E7%9A%84%E8%87%B4%E5%91%BD%E4%BB%A3%E4%BB%B7" target="_blank" rel="noreferrer">IM has rich functions to pay a fatal price</a>&quot;, that is, the characteristics that a project is proud of, may hide abyss behind it.</p><p>Java was once proud of <code>Everything is an object</code>, and emphasized that <code>Java has no structures or unions as complex data types. You don&#39;t need structures and unions when you have classes</code> (quoted from Sun&#39;s release in 1995 The Java white paper: <a href="https://www.stroustrup.com/1995_Java_whitepaper.pdf" target="_blank" rel="noreferrer">Simple, Object Oriented, and Familiar</a>) to promote Java is far easier to use than C and C++.</p><p>(Additional supplement: Looking at the development history of Java, developers will also lament the powerful vitality shown by Java&#39;s ability to continuously adapt to the development of the times, adjust its own development direction, and overcome five obstacles)</p><p>But in today&#39;s programming practice, advocating &quot;everything is an object&quot; without providing <code>structure</code> is more like a curse, such as when we put an <code>int</code> into a <code>List&lt;Integer&gt;</code>, we need a <code>new</code> New object, increasing the object header. In other words, as long as we use common data structures such as <code>List</code> and <code>Map</code> provided by Java, a lot of memory will be wasted in vain, and these collection classes are unavoidable in actual projects. (Supplement: In fact, internal data structures such as <code>HashSet</code> and <code>LinkedList</code> are more wasteful than the memory waste that many developers can imagine. The memory occupied by the object header is more than the actual data, so we see It will use &quot;shocking&quot; to evaluate its source code).</p><p>Today, the Valhalla project hopes to change this situation by introducing the <code>primitive/value class</code> language feature, but because it needs to be forward compatible with the huge Java ecosystem, and let Java get rid of the traditional curse of <code>everything is an object</code>, the Valhalla project The development of Java is on thin ice, and the design draft alone has been overturned many times. It has taken nearly 8 years to release the Preview feature, and it will take a long time for developers to re-acquaint themselves with the new Java language model in the future. It can be seen that a feature that a project is proud of at the beginning may become a &quot;curse&quot; in the middle and late stages of project development, causing headaches for both project maintainers and users.</p><p>The same is true for the design of IM functions. A design with strong vitality should follow the design concept of <code>Less is more</code>. &quot;Rich IM functions&quot; seems to be a feature to be proud of. At the beginning, developers thought that open source IM projects had all the functions for themselves, and they basically didn&#39;t have to do anything. But there is a price behind this, and the scalability of the project may be extremely poor. It is better to rewrite it yourself if you do expansion in the middle and late stages.</p></li><li><p>If there is no Valhalla project in Java, it is possible that the Turms server will initially be established in C# language.</p></li></ul><p>Reference document: <a href="https://openjdk.java.net/projects/valhalla/design-notes/state-of-valhalla/02-object-model" target="_blank" rel="noreferrer">Java language model under the Valhalla project</a></p><h2 id="thread" tabindex="-1">thread <a class="header-anchor" href="#thread" aria-label="Permalink to &quot;thread&quot;">​</a></h2><p>Since the Turms server does not have blocking I/O, network requests such as RPC, MongoDB, and Redis are all implemented asynchronously based on Netty. If you look further down, on the Linux system, they are all epoll-related operations. The number of threads required is far less than that of traditional Java web applications.</p><p>Taking a 16-core CPU as an example, the peak number of threads of turms-gateway and turms-service ranges from 80 to 140 (including JVM internal threads). The specific peak number depends on the number of CPU cores of the server and the running server. It depends on the number (for example, one turms-gateway can start the TCP/WebSocket/UDP server at the same time).</p><p>It is particularly worth mentioning that the peak number of threads in Turms has nothing to do with the scale of concurrent online users and the requested QPS.</p><p>Supplement: Because the number of threads used by the Turms server itself is not much compared to the number of CPU cores, we directly use <code>ThreadLocal</code> to cache some relatively large and thread-unsafe objects in individual codes, and compared with traditional On the server side, Turms also greatly reduces the overhead caused by thread context switching.</p><h3 id="cpu-health-monitoring" tabindex="-1">CPU health monitoring <a class="header-anchor" href="#cpu-health-monitoring" aria-label="Permalink to &quot;CPU health monitoring&quot;">​</a></h3><p>Configuration class: <code>im.turms.server.common.infra.property.env.common.healthcheck.CpuHealthCheckProperties</code></p><p>Function: Monitor the CPU usage. If the CPU usage exceeds the threshold for N times, set <code>isHealthy</code> of the node to <code>false</code>, and share this state with other nodes, and refuse to provide services until the CPU usage is healthy. For specific configuration, see the configuration class above.</p><h3 id="turms-thread-list" tabindex="-1">Turms thread list <a class="header-anchor" href="#turms-thread-list" aria-label="Permalink to &quot;Turms thread list&quot;">​</a></h3><table><thead><tr><th>scope of use</th><th>category</th><th>thread name</th><th>quantity</th><th>function</th></tr></thead><tbody><tr><td>General</td><td>Admin HTTP Server Thread</td><td>turms-admin-http-accptor</td><td>1</td><td>Admin HTTP Server Acceptor Thread</td></tr><tr><td></td><td></td><td>turms-admin-http-worker</td><td>Number of CPU cores</td><td>Admin HTTP server worker thread</td></tr><tr><td></td><td>User blacklist</td><td>turms-client-blocklist-sync</td><td>1</td><td>Used to synchronize blacklist data between clusters</td></tr><tr><td></td><td>health checker</td><td>turms-health-checker</td><td>1</td><td></td></tr><tr><td></td><td>Logging</td><td>turms-log-processor</td><td>1</td><td>Used for log formatting and output</td></tr><tr><td></td><td>Shutdown</td><td>turms-shutdown</td><td>1</td><td>When the server is shut down, schedule the Shutdown task of each component</td></tr><tr><td></td><td>Scheduled tasks</td><td>turms-task-manager</td><td>1</td><td>Used to schedule scheduled tasks</td></tr><tr><td></td><td>Cluster implementation</td><td>turms-node-connection-client-io</td><td>Number of CPU cores</td><td>Node communication I/O threads</td></tr><tr><td></td><td></td><td>turms-node-connection-keepalive</td><td>1</td><td>Used to regularly send heartbeats between nodes, and remove peer nodes with expired heartbeats</td></tr><tr><td></td><td></td><td>turms-node-connection-retry</td><td>1</td><td>Node connection retry thread</td></tr><tr><td></td><td></td><td>turms-node-connection-server-acceptor</td><td>1</td><td>Node connection server Acceptor thread</td></tr><tr><td></td><td></td><td>turms-node-connection-server-worker</td><td>Number of CPU cores</td><td>Node connection server Worker thread</td></tr><tr><td></td><td></td><td>turms-node-discovery-change-notifier</td><td>1</td><td>Node addition, deletion and modification event notification thread</td></tr><tr><td></td><td></td><td>turms-node-discovery-heartbeat-refresher</td><td>1</td><td>Used for the Leader node to refresh the heartbeat time in the service registry,</td></tr><tr><td></td><td>Redis client</td><td>lettuce-event-loop</td><td></td><td>Redis client I/O thread</td></tr><tr><td></td><td>MongoDB</td><td>turms-mongo-change-watcher</td><td>1</td><td>Used to execute the MongoDB Change Stream callback function</td></tr><tr><td></td><td></td><td>mongo-event-loop</td><td></td><td>MongoDB client I/O thread</td></tr><tr><td>turms-gateway</td><td>Fake client</td><td>turms-fake-client</td><td>Number of CPU cores</td><td>Fake Turms client I/O threads</td></tr><tr><td></td><td></td><td>turms-fake-client-manager</td><td>1</td><td>Schedule Fake Turms client to send requests</td></tr><tr><td></td><td></td><td>turms-client-heartbeat-refresher</td><td>1</td><td>Used to periodically refresh client heartbeats in batches</td></tr><tr><td></td><td>Gateway server</td><td>turms-gateway-udp-acceptor</td><td>1</td><td>UDP server Acceptor thread</td></tr><tr><td></td><td></td><td>turms-gateway-udp-worker</td><td>Number of CPU cores</td><td>UDP server worker thread</td></tr><tr><td></td><td></td><td>turms-gateway-tcp-acceptor</td><td>1</td><td>TCP server Acceptor thread</td></tr><tr><td></td><td></td><td>turms-gateway-tcp-worker</td><td>Number of CPU cores</td><td>TCP server worker thread</td></tr><tr><td></td><td></td><td>turms-gateway-ws-acceptor</td><td>1</td><td>WebSocket server Acceptor thread</td></tr><tr><td></td><td></td><td>turms-gateway-ws-worker</td><td>Number of CPU cores</td><td>WebSocket server worker threads</td></tr><tr><td></td><td></td><td>turms-gateway-idle-connection-timeout-timer</td><td>1</td><td>Used to monitor and close the network connection that has not established an application layer user session with the server for a long time</td></tr><tr><td></td><td>Client current limit and anti-swipe</td><td>turms-ip-request-token-bucket-cleaner</td><td>1</td><td>Used to clear expired Token Bucket data</td></tr></tbody></table><h3 id="threading-model" tabindex="-1">Threading Model <a class="header-anchor" href="#threading-model" aria-label="Permalink to &quot;Threading Model&quot;">​</a></h3><p>(Related documents: <a href="https://turms-im.github.io/docs/server/deployment/distribution#linux%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8F%82%E8%80%83%E9%85%8D%E7%BD%AE" target="_blank" rel="noreferrer">Linux System Reference Configuration</a>, <a href="https://turms-im.github.io/docs/server/development/code#%E7%BD%91%E7%BB%9C%E5%B1%82%E9%85%8D%E7%BD%AE" target="_blank" rel="noreferrer">source code-network configuration</a>)</p><h4 id="business-processing-tcp-websocket-server-and-http-background-management-api-server" tabindex="-1">Business processing TCP/WebSocket server and HTTP background management API server <a class="header-anchor" href="#business-processing-tcp-websocket-server-and-http-background-management-api-server" aria-label="Permalink to &quot;Business processing TCP/WebSocket server and HTTP background management API server&quot;">​</a></h4><p>Both the implementation of the business processing TCP/WebSocket server and the HTTP background management API server adopt the <code>master-slave Reactor multithreading model</code>. Specifically, an Acceptor thread (main Reactor group, Boss EventLoopGroup) and a Worker thread group with the number of CPU cores (slave Reactor group, Worker EventLoopGroup) are used. in:</p><ul><li><p>The Acceptor thread listens to the connection event of the TCP client from the <code>ServerSocketChannel</code> through the <code>io.netty.channel.nio.NioEventLoop#run</code> function, and creates a corresponding <code>SocketChannel</code> for the connected TCP client, and assigns it to a Worker thread for subsequent processing.</p><p>Acceptor thread name: <code>turms-gateway-tcp-acceptor</code>, <code>turms-gateway-ws-acceptor</code> or <code>turms-admin-http-acceptor</code>.</p><p>Mainly related to Linux system configuration: <code>net.core.somaxconn</code> (the maximum length of the TCP accept queue).</p></li><li><p>A Worker thread can bind and process multiple <code>SocketChannel</code>, and use <code>io.netty.channel.nio.NioEventLoop#run</code> to continuously monitor <code>SocketChannel</code> read events and need to process write tasks, and read and write words Execute a series of encoding and decoding functions of <code>ChannelHandler</code> in <code>ChannelPipeline</code> when throttling, and complete the task of byte encoding and decoding.</p><p>After the Worker thread completes the decoding work of the client request, the Worker thread will execute the <a href="https://turms-im.github.io/docs/server/development/code#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B" target="_blank" rel="noreferrer">source code-client request processing logic</a> (note: there is no need to switch threads here). In the process of processing this business request, the most time-consuming is the Protobuf decoding requested by the client and the encoding operation requested by MongoDB and Redis, while the IM logic only completes the scheduling of the IM business logic, so it is not time-consuming. In particular, during the processing of business requests, if a string needs to be <a href="https://turms-im.github.io/docs/server/module/anti-spam.html" target="_blank" rel="noreferrer">sensitive word filtering</a> detection, and using the <code>MASK_TEXT</code> strategy, its performance can be simply equal to Java<code>s </code>String#getBytes(&quot;UTF-8&quot;)`, so it is not time-consuming.</p><p>Worker thread name: <code>turms-gateway-tcp-worker</code>, <code>turms-gateway-ws-worker</code> or <code>turms-admin-http-worker</code>.</p><p>Main Linux system configuration: net.ipv4.tcp_mem, net.ipv4.tcp_rmem, net.ipv4.tcp_wmem</p></li></ul><h4 id="node-server-and-client" tabindex="-1">Node server and client <a class="header-anchor" href="#node-server-and-client" aria-label="Permalink to &quot;Node server and client&quot;">​</a></h4><p>TODO</p><h4 id="lettuce-and-mongodb-client" tabindex="-1">Lettuce and MongoDB client <a class="header-anchor" href="#lettuce-and-mongodb-client" aria-label="Permalink to &quot;Lettuce and MongoDB client&quot;">​</a></h4><p>TODO</p><h3 id="the-method-of-judging-which-thread-group-any-line-of-code-is-executed-on" tabindex="-1">The method of judging which thread group any line of code is executed on <a class="header-anchor" href="#the-method-of-judging-which-thread-group-any-line-of-code-is-executed-on" aria-label="Permalink to &quot;The method of judging which thread group any line of code is executed on&quot;">​</a></h3><p>After understanding the above-mentioned threading model of the Turms server, readers can easily determine which thread group any line of code on the Turms server will be executed on.</p><p>Taking the processing of client business requests as an example, starting from the fact that Netty&#39;s Worker thread reads the TurmsRequest byte stream sent by a Turms client, the entire business processing process will be executed on the Worker thread. After the logic, you can return to process other business requests.</p><p>During business process processing, Worker threads may trigger various network I/O operations, such as sending MongoDB and Redis client requests. When these network I/O operations are completed, there will be a series of business-related callback functions that need to be executed, and these callback functions will be executed on the MongoDB or Redis client NIO thread.</p><p>In short, all non-callback business processing codes seen by developers at the Service layer are executed on Worker threads, while various callback business processing codes are usually executed on NIO threads of MongoDB or Redis clients to execute. The admin API is the same.</p><h3 id="about-the-loom-project-codes-like-sync-works-like-async" tabindex="-1">About the Loom project - Codes like sync, works like async <a class="header-anchor" href="#about-the-loom-project-codes-like-sync-works-like-async" aria-label="Permalink to &quot;About the Loom project - Codes like sync, works like async&quot;">​</a></h3><h4 id="background" tabindex="-1">background <a class="header-anchor" href="#background" aria-label="Permalink to &quot;background&quot;">​</a></h4><p>On the one hand, many relatively long-lived technical solutions benefit from their rich ecology and longevity, on the other hand, because of their rich ecology, they are too big to lose their tails, and eventually withdraw from the stage of history because they cannot adapt to the development of the times. In the Java ecosystem, the blocking implementation of various technical solutions is actually a major obstacle that endangers the development of Java in the new era. Among them, the implementation of JDBC blocking is the biggest obstacle to the implementation of Java asynchronous ecology. One of the reasons why Turms did not adopt the traditional SQL database is that there was no mature asynchronous JDBC implementation in the Java ecosystem at that time, and even some projects did not use Java as a project. For languages such as Go or C#, only one sentence is left: &quot;Java&#39;s threading model is not &quot;cloud-native&quot; enough, and the ecosystem is too backward.&quot;</p><p>The revolutionary aspect of the Loom project is that it officially introduces virtual threads into the Java world, allowing seemingly synchronous code to be executed asynchronously.</p><h4 id="from-the-perspective-of-the-turms-server-talk-about-our-attitude-towards-the-loom-project" tabindex="-1">From the perspective of the Turms server, talk about our attitude towards the Loom project <a class="header-anchor" href="#from-the-perspective-of-the-turms-server-talk-about-our-attitude-towards-the-loom-project" aria-label="Permalink to &quot;From the perspective of the Turms server, talk about our attitude towards the Loom project&quot;">​</a></h4><p>Although the revolution of the Loom project is mentioned above, the Turms project will not adopt the coroutine provided by the Loom project in the future, because for the Turms server project, the coroutine can only add new problems (such as stack copying) and cannot Solve existing problems. The specific reasons are as follows:</p><ul><li><p>The revolutionary of the coroutine is that it tries to solve the status quo of the heavy use of blocking APIs (such as JDBC) in the Java ecosystem, allowing seemingly synchronous code to be executed asynchronously. However, the Turms server does not block I/O when processing client business requests, and the revolutionary nature of coroutines does not work on the Turms server. And if there is a third-party library that uses blocking I/O, then we usually have doubts about the technical level of its author and will not use its implementation.</p></li><li><p>The Loom project introduces a StackCopy-based coroutine, which needs to save the call stack to the heap when it is parked, and retrieve the call stack from the heap when it unparks and executes the thaw operation, but this does not affect the Turms server. It is superfluous, because the Turms server does not block I/O when processing client business requests, and does not need to park. Some articles promoting the Loom project will mention that coroutines have the advantage of &quot;even if you open tens of thousands of coroutines, you only need to occupy such a small amount of memory&quot;, but the Turms server only needs to open 0 coroutines, and use more than 0 bytes of memory. Memory can also achieve the same effect.</p><p>In addition, although saving the call stack can solve a major fatal shortcoming of reactor-core &quot;abnormal stack information is basically useless and difficult to debug&quot;, reactor-core has overcome this shortcoming under the optimization of the Turms server (see below for details<code>Supplement: Disadvantages of reactor-core</code>).</p></li><li><p>The learning difficulty of coroutine is &quot;1+1&gt;2&quot;, and its learning curve is actually higher than <code>reactor-core</code>. It is said that the difficulty of learning coroutines is &quot;1+1&gt;2&quot; because: developers must master the use, principle and optimization of threads and coroutines at the same time, and at the same time ensure that traditional code modeled on threads can run correctly Among coroutines, mastering <code>reactor-core</code> only requires the most basic knowledge of threads.</p><p>Some developers may think that the use of <code>reactor-core</code> is more complicated than coroutines, but such statements are usually only from the perspective of beginners. For junior engineers, whether it is a coroutine or <code>reactor-core</code>, the superficial use of both is actually very simple without learning its principles. Only in the early stages of developer learning, coroutines can ensure that junior engineers can easily write high-performance code at the Java level, and <code>reactor-core</code> is best written by senior engineers with junior programmers, otherwise the code may be maintained Poor performance, even logic errors. But as long as this short initial stage is passed, learning coroutines will face the problem of &quot;learning difficulty 1+1&gt;2&quot; just mentioned, and <code>reactor-core</code> only requires engineers to master the most basic thread knowledge.</p><p>As described in <code>The method of judging which thread group any line of code is executed on</code>, for <em>any line of code</em>* on the Turms server (including third-party libraries), we only need to rely on the most basic thread knowledge to accurately Infer which thread group this line of code will execute on, and who, where, and why this thread group was created, and what its life cycle is.</p><p>In addition, when we write Turms server code, we hardly consider &quot;how to write asynchronous code with reactor-core&quot;, just as many developers do not consider &quot;how to write synchronous code&quot;.</p></li><li><p>The compatibility of coroutines to the Java ecosystem is still a question mark. The Loom project itself still has a long way to go, and a large number of projects are needed to step on and verify. If a basic network library such as Netty, which is closely related to threads, has any negative optimization, explicit errors, or hidden unexpected behaviors when interacting with coroutines, its impact on upper-layer applications will be shaken.</p></li><li><p>Coroutines introduce a new abstraction layer (coroutines), and this layer of abstraction is redundant for the Turms server, which will only increase resource overhead and learning difficulty. Especially when we write performance-related key codes, we usually write the Java layer code from the perspective of system calls. Java just helps to cover the system calls with a layer of skin, and the thinner the skin, the better. In this way, we can quickly understand what syscall is called by the JVM to evaluate whether our Java layer code is efficient enough and whether there is room for optimization.</p></li><li><p>Java asynchronous implementation has about ten solutions so far, but in fact, no matter how tossed about the skin of the asynchronous model of Java, no matter how the ecology changes, no matter how &quot;revolutionary&quot;, the calling function of the system layer remains unchanged. For example, whether to use epoll or epoll, whether to use off-heap memory or off-heap memory. There is no need for the Turms server to use coroutines and introduce an additional abstraction layer because coroutines are more &quot;fashionable&quot;.</p></li><li><p>reactor-core not only implements asynchronous calls, but also has stronger expressive capabilities than coroutines. For example, if we want to know the measurement data such as the success rate and execution time of a link, we only need to call a function such as <code>metrics(...)</code>; The number of automatic retries only needs to call <code>retry(...)</code>; if you want to switch the execution thread of the data stream, you only need to execute a function like <code>publishOn(...)</code>, and the scheduling logic of the thread is under control among.</p></li></ul><p>To sum up, stacked coroutines can&#39;t play a role on the Turms server, and the performance will not be better than the reactor-core under the Turms server. There are still countless pits in the ecology that need to be stepped on and verified by projects. For the Turms service The meaningless abstraction of coroutines on the end is also redundant, which only increases the difficulty of learning. The expressive ability of reactor-core is also better than that of coroutines. It is difficult for the Turms server to have a reason to use coroutines.</p><p>Of course, the content mentioned above is mainly for the Turms server project. For most Java projects, the benefits of Loom outweigh the disadvantages. In particular, third-party library authors no longer need to maintain two sets of synchronous and asynchronous implementations.</p><h4 id="supplement-disadvantages-of-reactor-core" tabindex="-1">Supplement: Disadvantages of reactor-core <a class="header-anchor" href="#supplement-disadvantages-of-reactor-core" aria-label="Permalink to &quot;Supplement: Disadvantages of reactor-core&quot;">​</a></h4><p>As we are <a href="https://turms-im.github.io/docs/server/development/rules#%E5%85%B3%E4%BA%8E%E4%BE%9D%E8%B5%96%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8" target="_blank" rel="noreferrer">about the use of dependent libraries</a> As mentioned in the chapter, the asynchronous implementation library such as <code>reactor-core</code> is the best The fatal shortcoming is that when it is combined with some dependent libraries that advocate &quot;more encapsulation, more abstraction, and users do not need to close the implementation logic&quot;, developers can only hope that the server can always run normally, otherwise once a bug is encountered , developers will soon be unable to help but have a series of questions: &quot;Can an asynchronous framework like reactor-core be used in a production environment? I can&#39;t even find where the exception is thrown. Can such code really be maintained?&quot; Therefore, some technicians of the project team regretted using reactor-core, and even adopted other languages, such as Go, to rewrite the current Java project.</p><p>For example, the console now reports an error &quot;Netty Prompt: The reference count of ByteBuf has reached 0, and the release operation cannot be performed again&quot;. Pay special attention, this does not omit any useful log information, this is all the useful information that developers can really see from the log. Even this log has been stripped of misleading information, namely its stack information. If developers go to Debug according to the stack information, they will never be able to find the real Root Cause. And can developers know why this exception occurs and locate which module caused this exception based on this line of logs? This is a bug that actually happened in Turms, and it is also the only one that spent more than 6 hours reading all the network I/O related source codes that Turms depends on, and troubleshooting the most difficult bug of Root Cause: <a href="https://github.com/turms-im/turms/issues/786" target="_blank" rel="noreferrer">Memory leaks when Turms uses the previous buffer reference to release a recycled pooled buffer</a>.</p><p>In short, to use <code>reactor-core</code> well, three conditions must be met:</p><ol><li>All key codes must be controllable, otherwise when something goes wrong, you can only hope for:</li></ol><ul><li><p>The developers of the third-party library have high technical level and solid code design skills. If the third-party dependency is also based on asynchronous programming, the requirements are even higher. The author must be able to predict the exceptions that upper-layer developers may encounter, and throw the exceptions to the upper-layer application through asynchronous means.</p></li><li><p>The third-party library is not complicated, and you can quickly read the relevant source code.</p><p>A good example is: reactor-netty. Its developers have a high technical level and solid design skills. The code is also relatively streamlined and easy to read.</p></li></ul><ol start="2"><li><p>The exception and print log must be passed in a standardized manner. Even for asynchronous programming, as long as exceptions are transmitted and logs are printed in a standardized manner, we can immediately see the cause of most bugs through a single log. Only a few bugs may need to be associated with multiple logs for troubleshooting. If you can&#39;t do this, you can only resign yourself to fate when things go wrong.</p></li><li><p>There must be engineers in the team who are proficient in asynchronous programming.</p></li></ol><p>As long as one of the above conditions is missing, developers will sooner or later encounter such difficult bugs as &quot;Netty prompt: the reference count of ByteBuf has reached 0 and cannot be released again&quot;. Therefore, for general technical teams, we recommend The Loom project, not reactor-core. Of course, it may be more recommended to switch programming languages. However, the Turms project can now meet the above conditions, and there is no longer the situation of &quot;extremely difficult to debug&quot;.</p><p>Extras:</p><ul><li>Some articles will say that asynchronous frameworks like reactor-core are easy to write callback hell. However, as mentioned above, reactor-core itself has a strong expressive ability. In fact, developers &quot;can write several layers of call levels if they want to design several layers&quot;. In other words, if the highest calling level of a function is 5 levels, then reactor-core can be used to write 5/4/3/2/1 level codes. In practice, the nested callback functions of the Turms server are all nested to reduce intermediate objects or implement stack allocation (rather than heap allocation). For details, see the source code of the Turms server.</li><li>When developing the turms-admin management system, we usually try to avoid using <code>await/async</code> as much as possible. The reason is that turms-admin will eventually transpile into ES5 syntax, and the functions modified by <code>await/async</code> are in the <code>source map </code>After closing, it is very difficult to debug, so try to avoid <code>await/async</code>.</li></ul></div></div></main><footer class="VPDocFooter" data-v-6b87e69f data-v-ef5dee53><!--[--><!--]--><!----><nav class="prev-next" data-v-ef5dee53><div class="pager" data-v-ef5dee53><a class="pager-link prev" href="/docs/server/module/cluster.html" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Previous page</span><span class="title" data-v-ef5dee53>Cluster Design and Implementation</span></a></div><div class="pager" data-v-ef5dee53><a class="pager-link next" href="/docs/server/module/observability.html" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Next page</span><span class="title" data-v-ef5dee53>Observability</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"client_turms-chat-demo.md\":\"7b5e1548\",\"zh-cn_reference_status-code.md\":\"0a40300d\",\"client_turms-client-js.md\":\"90459bf7\",\"turms-admin.md\":\"e78a83e8\",\"design_architecture.md\":\"a62a79fa\",\"zh-cn_feature_message.md\":\"0c4082f1\",\"client_metrics.md\":\"d00c67a6\",\"client_session.md\":\"aad38adf\",\"design_status-aware.md\":\"f346f12c\",\"zh-cn_server_deployment_config.md\":\"991cc337\",\"feature_message.md\":\"5a764148\",\"zh-cn_server_deployment_getting-started.md\":\"bc587018\",\"feature_group.md\":\"82db277a\",\"feature_index.md\":\"dc889387\",\"zh-cn_reference_admin-api.md\":\"aa307b66\",\"zh-cn_server_module_xmpp.md\":\"d1012659\",\"feature_user.md\":\"a73ae67a\",\"zh-cn_client_quick-start.md\":\"242732d8\",\"index.md\":\"88e8fd9c\",\"zh-cn_server_module_storage.md\":\"7a7fd54a\",\"zh-cn_client_metrics.md\":\"4e0dce30\",\"zh-cn_server_deployment_distribution.md\":\"6598d373\",\"feature_simultaneous-login.md\":\"f7c62cdc\",\"client_api.md\":\"97fe29c4\",\"server_module_cluster.md\":\"871e6a9f\",\"server_module_data-analytics.md\":\"89dd732f\",\"zh-cn_client_session.md\":\"8e3853f1\",\"server_development_redevelopment.md\":\"fbceab5a\",\"server_module_identity-access-management.md\":\"4d1d60bf\",\"server_deployment_getting-started.md\":\"db0bd29d\",\"server_development_code.md\":\"8d1c62a0\",\"zh-cn_client_requirements.md\":\"334bb1c0\",\"server_module_chatbot.md\":\"a5496727\",\"server_development_plugin.md\":\"0ab61579\",\"zh-cn_community_index.md\":\"7d14e5f0\",\"zh-cn_design_architecture.md\":\"1e666ada\",\"zh-cn_index.md\":\"19b7ad26\",\"community_index.md\":\"d5c5ea8c\",\"design_schema.md\":\"32995249\",\"server_deployment_distribution.md\":\"76550939\",\"zh-cn_feature_index.md\":\"35f4ed6d\",\"zh-cn_client_communication-protocol.md\":\"c3b01846\",\"server_development_testing.md\":\"bcef65b5\",\"zh-cn_design_schema.md\":\"067d7975\",\"zh-cn_design_status-aware.md\":\"02556b58\",\"zh-cn_client_api.md\":\"5b13f5b3\",\"reference_status-code.md\":\"8a608fc0\",\"zh-cn_server_module_system-resource-management.md\":\"71ac4014\",\"zh-cn_server_development_rules.md\":\"d361d583\",\"zh-cn_server_module_anti-spam.md\":\"4c2dcfde\",\"zh-cn_server_module_cluster.md\":\"a5af839f\",\"zh-cn_server_module_identity-access-management.md\":\"33a2fed4\",\"zh-cn_server_module_data-analytics.md\":\"0e180478\",\"reference_admin-api.md\":\"cd1aa4c1\",\"client_communication-protocol.md\":\"ece16fe5\",\"client_quick-start.md\":\"2495bdda\",\"client_requirements.md\":\"2fe21189\",\"zh-cn_server_module_security.md\":\"e70930d1\",\"server_development_rules.md\":\"d366e1d5\",\"zh-cn_client_turms-chat-demo.md\":\"8c9402cb\",\"server_module_anti-spam.md\":\"1eb3d9b0\",\"server_module_storage.md\":\"53d425fa\",\"zh-cn_client_turms-client-js.md\":\"de32f7bf\",\"zh-cn_server_module_chatbot.md\":\"8b1749eb\",\"server_module_xmpp.md\":\"dcf5ade5\",\"server_deployment_config.md\":\"082bb81b\",\"zh-cn_feature_user.md\":\"512ab7fc\",\"server_module_system-resource-management.md\":\"14cf6b55\",\"zh-cn_server_development_testing.md\":\"7382a948\",\"zh-cn_server_module_observability.md\":\"f5a551b7\",\"server_module_observability.md\":\"536db662\",\"zh-cn_server_development_code.md\":\"a90098da\",\"zh-cn_turms-admin.md\":\"b9c1d665\",\"zh-cn_server_development_plugin.md\":\"35ccbe27\",\"server_module_security.md\":\"2811177b\",\"zh-cn_feature_group.md\":\"cb522884\",\"zh-cn_server_development_redevelopment.md\":\"55189f5c\",\"zh-cn_feature_simultaneous-login.md\":\"d2fc551a\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Turms Documentation\",\"description\":\"A VitePress site\",\"base\":\"/docs/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"logo\":\"https://raw.githubusercontent.com/turms-im/assets/master/logo/pegion.svg\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/turms-im/turms\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"WV3XO0QV2E\",\"apiKey\":\"f7a7c652875d1f2cc0f0ec52d8f8f660\",\"indexName\":\"turms-imio\",\"locales\":{\"zh-CN\":{\"placeholder\":\"搜索\",\"translations\":{\"button\":{\"buttonText\":\"搜索\",\"buttonAriaLabel\":\"搜索\"},\"modal\":{\"searchBox\":{\"resetButtonTitle\":\"重置查询\",\"resetButtonAriaLabel\":\"重置查询\",\"cancelButtonText\":\"取消\",\"cancelButtonAriaLabel\":\"取消\"},\"startScreen\":{\"recentSearchesTitle\":\"搜索历史\",\"noRecentSearchesText\":\"没有搜索历史\",\"saveRecentSearchButtonTitle\":\"保存至搜索历史\",\"removeRecentSearchButtonTitle\":\"从搜索历史中移除\",\"favoriteSearchesTitle\":\"收藏\",\"removeFavoriteSearchButtonTitle\":\"从收藏中移除\"},\"errorScreen\":{\"titleText\":\"无法获取搜索结果\",\"helpText\":\"请检查网络连接\"},\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\",\"closeText\":\"关闭\",\"searchByText\":\"搜索提供者\"},\"noResultsScreen\":{\"noResultsText\":\"没有找到相关结果\",\"suggestedQueryText\":\"您可能想搜索\",\"reportMissingResultsLinkText\":\"点击反馈\",\"reportMissingResultsText\":\"没有找到结果？请报告缺失\"}}}}}}}},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"themeConfig\":{\"sidebar\":[{\"text\":\"Introduction\",\"link\":\"/index.md\"},{\"text\":\"Community FAQ\",\"link\":\"/community/index.md\"},{\"text\":\"Business Features\",\"collapsed\":true,\"items\":[{\"text\":\"Business Features\",\"link\":\"/feature/index.md\"},{\"text\":\"Simultaneous Login\",\"link\":\"/feature/simultaneous-login.md\"},{\"text\":\"User-related Features\",\"link\":\"/feature/user.md\"},{\"text\":\"Group-related Features\",\"link\":\"/feature/group.md\"},{\"text\":\"Message-related Features\",\"link\":\"/feature/message.md\"}]},{\"text\":\"Design\",\"collapsed\":true,\"items\":[{\"text\":\"Architecture Design\",\"link\":\"/design/architecture.md\"},{\"text\":\"Collection Schema Design\",\"link\":\"/design/schema.md\"},{\"text\":\"Status Awareness\",\"link\":\"/design/status-aware.md\"}]},{\"text\":\"Server Guide\",\"collapsed\":true,\"items\":[{\"text\":\"Deployment\",\"items\":[{\"text\":\"Build and Start\",\"link\":\"/server/deployment/getting-started.md\"},{\"text\":\"Distribution\",\"link\":\"/server/deployment/distribution.md\"},{\"text\":\"Configuration\",\"link\":\"/server/deployment/config.md\"}]},{\"text\":\"Development\",\"items\":[{\"text\":\"About Secondary Development\",\"link\":\"/server/development/redevelopment.md\"},{\"text\":\"Basic Development Rules\",\"link\":\"/server/development/rules.md\"},{\"text\":\"Custom Plugins\",\"link\":\"/server/development/plugin.md\"},{\"text\":\"Source Code\",\"link\":\"/server/development/code.md\"},{\"text\":\"Testing\",\"link\":\"/server/development/testing.md\"}]},{\"text\":\"Main Modules\",\"items\":[{\"text\":\"Identity and Access Management\",\"link\":\"/server/module/identity-access-management.md\"},{\"text\":\"Cluster Design and Implementation\",\"link\":\"/server/module/cluster.md\"},{\"text\":\"System Resource Management\",\"link\":\"/server/module/system-resource-management.md\"},{\"text\":\"Observability\",\"link\":\"/server/module/observability.md\"},{\"text\":\"Security\",\"link\":\"/server/module/security.md\"},{\"text\":\"XMPP\",\"link\":\"/server/module/xmpp.md\"},{\"text\":\"Storage Service\",\"link\":\"/server/module/storage.md\"},{\"text\":\"Chatbot\",\"link\":\"/server/module/chatbot.md\"},{\"text\":\"Content Moderation\",\"link\":\"/server/module/anti-spam.md\"},{\"text\":\"Data Analysis\",\"link\":\"/server/module/data-analytics.md\"}]}]},{\"text\":\"Client Guide\",\"collapsed\":true,\"items\":[{\"text\":\"Quick Start\",\"link\":\"/client/quick-start.md\"},{\"text\":\"Version Requirements\",\"link\":\"/client/requirements.md\"},{\"text\":\"API\",\"link\":\"/client/api.md\"},{\"text\":\"Session Lifecycle\",\"link\":\"/client/session.md\"},{\"text\":\"Metrics\",\"link\":\"/client/metrics.md\"},{\"text\":\"Communication Protocol Used Between Client and Server\",\"link\":\"/client/communication-protocol.md\"},{\"text\":\"turms-client-js Shared Context\",\"link\":\"/client/turms-client-js.md\"},{\"text\":\"Turms Chat Demo\",\"link\":\"/client/turms-chat-demo.md\"}]},{\"text\":\"turms-admin\",\"link\":\"/turms-admin.md\"},{\"text\":\"Reference\",\"collapsed\":true,\"items\":[{\"text\":\"Admin API\",\"link\":\"/reference/admin-api.md\"},{\"text\":\"Status Code\",\"link\":\"/reference/status-code.md\"}]}]}},\"zh-CN\":{\"label\":\"简体中文\",\"lang\":\"zh-CN\",\"themeConfig\":{\"lastUpdatedText\":\"上次更新\",\"outline\":{\"label\":\"当前页\"},\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"sidebar\":[{\"text\":\"介绍\",\"link\":\"/zh-CN/index.md\"},{\"text\":\"社区常见问题\",\"link\":\"/zh-CN/community/index.md\"},{\"text\":\"业务功能\",\"collapsed\":true,\"items\":[{\"text\":\"业务功能介绍\",\"link\":\"/zh-CN/feature/index.md\"},{\"text\":\"多端登录\",\"link\":\"/zh-CN/feature/simultaneous-login.md\"},{\"text\":\"用户相关功能\",\"link\":\"/zh-CN/feature/user.md\"},{\"text\":\"群组相关功能\",\"link\":\"/zh-CN/feature/group.md\"},{\"text\":\"消息相关功能\",\"link\":\"/zh-CN/feature/message.md\"}]},{\"text\":\"设计\",\"collapsed\":true,\"items\":[{\"text\":\"架构设计\",\"link\":\"/zh-CN/design/architecture.md\"},{\"text\":\"集合结构设计\",\"link\":\"/zh-CN/design/schema.md\"},{\"text\":\"状态感知\",\"link\":\"/zh-CN/design/status-aware.md\"}]},{\"text\":\"服务端指南\",\"collapsed\":true,\"items\":[{\"text\":\"部署\",\"items\":[{\"text\":\"搭建与启动\",\"link\":\"/zh-CN/server/deployment/getting-started.md\"},{\"text\":\"发布\",\"link\":\"/zh-CN/server/deployment/distribution.md\"},{\"text\":\"配置参数\",\"link\":\"/zh-CN/server/deployment/config.md\"}]},{\"text\":\"开发\",\"items\":[{\"text\":\"关于二次开发\",\"link\":\"/zh-CN/server/development/redevelopment.md\"},{\"text\":\"基本开发规约\",\"link\":\"/zh-CN/server/development/rules.md\"},{\"text\":\"自定义插件\",\"link\":\"/zh-CN/server/development/plugin.md\"},{\"text\":\"源码\",\"link\":\"/zh-CN/server/development/code.md\"},{\"text\":\"测试\",\"link\":\"/zh-CN/server/development/testing.md\"}]},{\"text\":\"主要模块\",\"items\":[{\"text\":\"身份与访问管理\",\"link\":\"/zh-CN/server/module/identity-access-management.md\"},{\"text\":\"集群的设计与实现\",\"link\":\"/zh-CN/server/module/cluster.md\"},{\"text\":\"系统资源管理\",\"link\":\"/zh-CN/server/module/system-resource-management.md\"},{\"text\":\"可观测性体系\",\"link\":\"/zh-CN/server/module/observability.md\"},{\"text\":\"安全\",\"link\":\"/zh-CN/server/module/security.md\"},{\"text\":\"XMPP\",\"link\":\"/zh-CN/server/module/xmpp.md\"},{\"text\":\"存储服务\",\"link\":\"/zh-CN/server/module/storage.md\"},{\"text\":\"聊天机器人\",\"link\":\"/zh-CN/server/module/chatbot.md\"},{\"text\":\"敏感词过滤\",\"link\":\"/zh-CN/server/module/anti-spam.md\"},{\"text\":\"数据分析\",\"link\":\"/zh-CN/server/module/data-analytics.md\"}]}]},{\"text\":\"客户端指南\",\"collapsed\":true,\"items\":[{\"text\":\"Quick Start\",\"link\":\"/zh-CN/client/quick-start.md\"},{\"text\":\"版本要求\",\"link\":\"/zh-CN/client/requirements.md\"},{\"text\":\"接口\",\"link\":\"/zh-CN/client/api.md\"},{\"text\":\"会话的生命周期\",\"link\":\"/zh-CN/client/session.md\"},{\"text\":\"度量数据\",\"link\":\"/zh-CN/client/metrics.md\"},{\"text\":\"与服务端通信时使用的数据格式\",\"link\":\"/zh-CN/client/communication-protocol.md\"},{\"text\":\"turms-client-js共享上下文\",\"link\":\"/zh-CN/client/turms-client-js.md\"},{\"text\":\"Turms Chat Demo\",\"link\":\"/zh-CN/client/turms-chat-demo.md\"}]},{\"text\":\"turms-admin\",\"link\":\"/zh-CN/turms-admin.md\"},{\"text\":\"手册\",\"collapsed\":true,\"items\":[{\"text\":\"管理员API接口\",\"link\":\"/zh-CN/reference/admin-api.md\"},{\"text\":\"状态码\",\"link\":\"/zh-CN/reference/status-code.md\"}]}]}}},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>