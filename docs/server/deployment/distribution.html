<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Distribution | Turms Documentation</title>
    <meta name="description" content="A VitePress site">
    <meta name="generator" content="VitePress v1.2.0">
    <link rel="preload stylesheet" href="/docs/assets/style.BHGQ7U4S.css" as="style">
    
    <script type="module" src="/docs/assets/app.5bekgGnH.js"></script>
    <link rel="preload" href="/docs/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/docs/assets/chunks/framework.ViWktWD6.js">
    <link rel="modulepreload" href="/docs/assets/chunks/theme.PziOlW20.js">
    <link rel="modulepreload" href="/docs/assets/server_deployment_distribution.md.BtNqIqjJ.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar has-sidebar top" data-v-ae24b3ad data-v-ccf7ddec><div class="wrapper" data-v-ccf7ddec><div class="container" data-v-ccf7ddec><div class="title" data-v-ccf7ddec><div class="VPNavBarTitle has-sidebar" data-v-ccf7ddec data-v-ab179fa1><a class="title" href="/docs/" data-v-ab179fa1><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://raw.githubusercontent.com/turms-im/assets/master/logo/pegion.svg" alt data-v-8426fc1a><!--]--><span data-v-ab179fa1>Turms Documentation</span><!--[--><!--]--></a></div></div><div class="content" data-v-ccf7ddec><div class="content-body" data-v-ccf7ddec><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ccf7ddec><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><div class="VPFlyout VPNavBarTranslations translations" data-v-ccf7ddec data-v-88af2de4 data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><span class="vpi-languages option-icon" data-v-b6c34ac9></span><!----><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><div class="items" data-v-88af2de4><p class="title" data-v-88af2de4>English</p><!--[--><div class="VPMenuLink" data-v-88af2de4 data-v-43f1e123><a class="VPLink link" href="/docs/zh-CN/server/deployment/distribution.html" data-v-43f1e123><!--[-->简体中文<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-ccf7ddec data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-e6aabb21 data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ccf7ddec data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/turms-im/turms" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ccf7ddec data-v-d0bd9dde data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><div class="group translations" data-v-d0bd9dde><p class="trans-title" data-v-d0bd9dde>English</p><!--[--><div class="VPMenuLink" data-v-d0bd9dde data-v-43f1e123><a class="VPLink link" href="/docs/zh-CN/server/deployment/distribution.html" data-v-43f1e123><!--[-->简体中文<!--]--></a></div><!--]--></div><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d0bd9dde data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/turms-im/turms" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ccf7ddec data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-ccf7ddec><div class="divider-line" data-v-ccf7ddec></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-575e6a36><div class="curtain" data-v-575e6a36></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-575e6a36><span class="visually-hidden" id="sidebar-aria-label" data-v-575e6a36> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0" data-v-575e6a36 data-v-b8d55f3b><!----><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/index.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Introduction</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/community/index.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Community FAQ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Business Features</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/feature/index.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Business Features</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/feature/simultaneous-login.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Simultaneous Login</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/feature/user.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>User-related Features</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/feature/group.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Group-related Features</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/feature/message.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Message-related Features</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Design</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/design/architecture.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Architecture Design</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/design/schema.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Collection Schema Design</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/design/status-aware.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Status Awareness</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible has-active" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Server Guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><section class="VPSidebarItem level-1 has-active" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>Deployment</h3><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/deployment/getting-started.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Build and Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/deployment/distribution.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Distribution</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/deployment/config.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Configuration</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>Development</h3><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/development/redevelopment.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>About Secondary Development</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/development/rules.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Basic Development Rules</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/development/plugin.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Custom Plugins</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/development/code.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Source Code</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/development/testing.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Testing</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>Main Modules</h3><!----></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/identity-access-management.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Identity and Access Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/cluster.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Cluster Design and Implementation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/system-resource-management.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>System Resource Management</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/observability.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Observability</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/security.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Security</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/xmpp.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>XMPP</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/storage.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Storage Service</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/chatbot.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Chatbot</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/anti-spam.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Content Moderation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/server/module/data-analytics.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Data Analysis</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Client Guide</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/quick-start.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Quick Start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/requirements.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Version Requirements</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/api.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/session.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Session Lifecycle</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/metrics.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Metrics</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/communication-protocol.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Communication Protocol Used Between Client and Server</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/turms-client-js.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>turms-client-js Shared Context</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/client/turms-chat-demo.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Turms Chat Demo</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0" data-v-575e6a36 data-v-b8d55f3b><!----><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/turms-admin.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>turms-admin</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Reference</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/reference/admin-api.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Admin API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/docs/reference/status-code.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Status Code</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-269c27a6><div class="content" data-v-269c27a6><div class="outline-marker" data-v-269c27a6></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-269c27a6>On this page</div><ul class="VPDocOutlineItem root" data-v-269c27a6 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _docs_server_deployment_distribution" data-v-39a288b8><div><h1 id="distribution" tabindex="-1">Distribution <a class="header-anchor" href="#distribution" aria-label="Permalink to &quot;Distribution&quot;">​</a></h1><h2 id="the-directory-structure-of-server-release-package" tabindex="-1">The Directory Structure of Server Release Package <a class="header-anchor" href="#the-directory-structure-of-server-release-package" aria-label="Permalink to &quot;The Directory Structure of Server Release Package&quot;">​</a></h2><p>The directory structure of the turms-gateway and turms-service server release packages is as follows:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>├─bin</span></span>
<span class="line"><span>│ └─run.sh</span></span>
<span class="line"><span>├─config</span></span>
<span class="line"><span>│ ├─application.yaml</span></span>
<span class="line"><span>│ └─jvm.options</span></span>
<span class="line"><span>├─hprof</span></span>
<span class="line"><span>├─jdk</span></span>
<span class="line"><span>│─jfr</span></span>
<span class="line"><span>│─lib</span></span>
<span class="line"><span>│ ├─turms-gateway.jar (or turms-service.jar)</span></span>
<span class="line"><span>│ └─... jar</span></span>
<span class="line"><span>│─log</span></span>
<span class="line"><span>└─plugins</span></span></code></pre></div><table><thead><tr><th>directory</th><th>must exist</th><th>role</th></tr></thead><tbody><tr><td>bin</td><td>no</td><td>Holds executable scripts. run.sh is used to read the context configuration and start the Turms server</td></tr><tr><td>config</td><td>yes</td><td>Store configuration files. <br>application.yaml is used to override and add application layer configuration (such as Spring, Turms and other configurations); <br>jvm.options is used to set JVM configuration. Normally, you don&#39;t need to modify this file directly, but add JVM configuration through the environment variable <code>TURMS_GATEWAY_JVM_OPTS</code> (or <code>TURMS_SERVICE_JVM_OPTS</code>)</td></tr><tr><td>hprof</td><td>no</td><td>store heap dump snapshots</td></tr><tr><td>jdk</td><td>no</td><td>Store the JDK. The bin script uses the JDK under <code>JAVA_HOME</code> first. If you do not set the <code>JAVA_HOME</code> environment variable, use the JDK under this directory</td></tr><tr><td>jfr</td><td>No</td><td>Store JFR real-time flight record information</td></tr><tr><td>lib</td><td>Yes</td><td>Store runtime Jar package dependencies, excluding custom plug-in implementations</td></tr><tr><td>log</td><td>No</td><td>Store logs (including GC logs, API call logs, application logs, etc.)</td></tr><tr><td>plugins</td><td>No</td><td>Jar package dependencies for storing plugins. Note that the Turms server will only detect whether the JAR package ending with <code>jar</code> in the <code>plugins</code> directory is a plug-in implementation, so if you put the plug-in JAR package in the <code>lib</code> directory, these plug-ins will not be recognized. use</td></tr></tbody></table><p>Note: The environment variable <code>TURMS_GATEWAY_HOME</code> (corresponding to the turms-gateway server) or <code>TURMS_SERVICE_HOME</code> (corresponding to the turms-service server) is very important for the run.sh script and the turms server to read and store data correctly. If you run the Turms server through run.sh or a Docker image, and you do not set the above environment variables, the run.sh script will automatically deduce the HOME directory location. If you do not run it through the above method (such as starting directly through the IDE), it is recommended that you manually configure the <code>TURMS_GATEWAY_HOME</code> or <code>TURMS_SERVICE_HOME</code> environment variable, otherwise the Turms server will use <code>.</code> (current directory) as the HOME environment.</p><h2 id="docker-images" tabindex="-1">Docker Images <a class="header-anchor" href="#docker-images" aria-label="Permalink to &quot;Docker Images&quot;">​</a></h2><p>It is strongly recommended that you use a Docker image to deploy the Turms server.</p><p>At present, the version number of the Docker image on the Turms server is <code>latest</code>, that is, the image with a specific version number is not provided for the time being. The specific command to pull the image is as follows:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ghcr.io/turms-im/turms-admin:latest</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ghcr.io/turms-im/turms-gateway:latest</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ghcr.io/turms-im/turms-service:latest</span></span></code></pre></div><h2 id="custom-publish-artifacts" tabindex="-1">Custom Publish Artifacts <a class="header-anchor" href="#custom-publish-artifacts" aria-label="Permalink to &quot;Custom Publish Artifacts&quot;">​</a></h2><p>If users don&#39;t want to use the official products provided by Turms (such as Docker image), they can also generate the products they need according to the source code and scripts of Turms projects. Although the packaging and release process of each sub-project of Turms is open source, considering that if users need to search the warehouse for research, the learning efficiency is relatively low, so this article summarizes the generation methods of each product:</p><table><thead><tr><th>Projects</th><th>Products</th><th>Reference Methods</th></tr></thead><tbody><tr><td>turms-gateway</td><td>Fat/Uber JAR package (including dependencies)</td><td>1. Install <a href="https://adoptium.net/temurin/releases" target="_blank" rel="noreferrer">Temurin JDK 21</a><br>2. Install <a href="https://maven.apache.org/download.cgi" target="_blank" rel="noreferrer">Maven 3</a><br>3. Execute <code>mvn clean package -am -B -DskipUTs -DskipITs -P artifact-fat-jar -pl turms in the root directory of the Turms project -gateway --no-transfer-progress</code></td></tr><tr><td></td><td>Thin JAR package (the package does not include dependent packages)</td><td>1. Install <a href="https://adoptium.net/temurin/releases" target="_blank" rel="noreferrer">Temurin JDK 21</a><br>2. Install [Maven 3](https:/ /maven.apache.org/download.cgi)<br>3. In the root directory of the Turms project, execute the command <code>mvn clean package -am -B -DskipUTs -DskipITs -P artifact-thin-jar -pl turms-gateway - -no-transfer-progress</code></td></tr><tr><td></td><td>Docker image (linux/amd64)</td><td>1. Install <a href="https://docs.docker.com/engine/install" target="_blank" rel="noreferrer">Docker</a><br>2. Execute the command <code>docker build -- in the root directory of the Turms project rm=false -t &quot;www.mydomain.com/turms-im/turms-gateway:latest&quot; -f turms-gateway/Dockerfile .</code></td></tr><tr><td></td><td>Docker image (linux/arm64)</td><td>(cross-compilation)<br>If users use GitHub Action, they can directly reuse the <code>.github/workflows/publish-turms-gateway.yml</code> script under the Turms project for image packaging . <br>If the user does not use GitHub Action, and the system is not <code>linux/arm64</code>, cross-compilation is required. The specific method is as follows:<br>1. Install <a href="https://docs.docker.com/engine/install" target="_blank" rel="noreferrer">Docker</a><br>2. Install [buildx and QEMU](<a href="https://docs.docker" target="_blank" rel="noreferrer">https://docs.docker</a>. com/build/building/multi-platform)<br>3. In the root directory of the Turms project, execute the command <code>DOCKER_BUILDKIT=1 docker buildx build --platform linux/arm64 --rm=false -t &quot;www.mydomain.com /turms-im/turms-gateway:latest&quot; -f turms-gateway/Dockerfile .</code></td></tr><tr><td>turms-service</td><td>Fat/Uber JAR package (including dependencies)</td><td>1. Install <a href="https://adoptium.net/temurin/releases" target="_blank" rel="noreferrer">Temurin JDK 21</a><br>2. Install <a href="https://maven.apache.org/download.cgi" target="_blank" rel="noreferrer">Maven 3</a><br>3. Execute <code>mvn clean package -am -B -DskipUTs -DskipITs -P artifact-fat-jar -pl turms in the root directory of the Turms project -service --no-transfer-progress</code></td></tr><tr><td></td><td>Thin JAR package (the package does not include dependent packages)</td><td>1. Install <a href="https://adoptium.net/temurin/releases" target="_blank" rel="noreferrer">Temurin JDK 21</a><br>2. Install [Maven 3](https:/ /maven.apache.org/download.cgi)<br>3. In the root directory of the Turms project, execute the command <code>mvn clean package -am -B -DskipUTs -DskipITs -P artifact-thin-jar -pl turms-service - -no-transfer-progress</code></td></tr><tr><td></td><td>Docker image (linux/amd64)</td><td>1. Install <a href="https://docs.docker.com/engine/install" target="_blank" rel="noreferrer">Docker</a><br>2. Execute the command <code>docker build -- in the root directory of the Turms project rm=false -t &quot;www.mydomain.com/turms-im/turms-service:latest&quot; -f turms-service/Dockerfile .</code></td></tr><tr><td></td><td>Docker image (linux/arm64)</td><td>(cross-compilation)<br>If users use GitHub Action, they can directly reuse the <code>.github/workflows/publish-turms-service.yml</code> script under the Turms project for image packaging . <br>If the user does not use GitHub Action, and the system is not <code>linux/arm64</code>, cross-compilation is required. The specific method is as follows:<br>1. Install <a href="https://docs.docker.com/engine/install" target="_blank" rel="noreferrer">Docker</a><br>2. Install <a href="https://docs.docker.com/build/building/multi-platform" target="_blank" rel="noreferrer">buildx and QEMU</a><br>3. In the root directory of the Turms project, execute the command <code>DOCKER_BUILDKIT=1 docker buildx build --platform linux/arm64 --rm=false -t &quot;www.mydomain.com /turms-im/turms-service:latest&quot; -f turms-service/Dockerfile .</code></td></tr><tr><td>turms-admin</td><td>Static resources (such as HTML, JavaScript, CSS, etc.)</td><td>1. Install <a href="https://nodejs.org/en/download" target="_blank" rel="noreferrer">Node.js 18</a><br>2. In turms-admin Execute the command <code>npm i --no-optional &amp;&amp; npm run build</code> under the project</td></tr><tr><td></td><td>Docker image with Nginx service (linux/amd64)</td><td>1. Install <a href="https://docs.docker.com/engine/install" target="_blank" rel="noreferrer">Docker</a><br>2. Execute the command in the root directory of the Turms project<code> docker build --rm=false -t &quot;www.mydomain.com/turms-im/turms-admin:latest&quot; -f turms-admin/Dockerfile .</code></td></tr><tr><td></td><td>Docker image with Nginx service (linux/arm64)</td><td>(cross-compilation)<br>If users use GitHub Action, they can directly reuse <code>.github/workflows/publish-turms-admin.yml</code> under the Turms project The script performs image packaging. <br>If the user does not use GitHub Action, and the system is not <code>linux/arm64</code>, cross-compilation is required. The specific method is as follows:<br>1. Install <a href="https://docs.docker.com/engine/install" target="_blank" rel="noreferrer">Docker</a><br>2. Install [buildx and QEMU](<a href="https://docs.docker" target="_blank" rel="noreferrer">https://docs.docker</a>. com/build/building/multi-platform)<br>3. In the root directory of the Turms project, execute the command <code>DOCKER_BUILDKIT=1 docker buildx build --platform linux/arm64 --rm=false -t &quot;www.mydomain.com /turms-im/turms-admin:latest&quot; -f turms-admin/Dockerfile .</code></td></tr><tr><td>turms-client-dart</td><td>No packaging required</td><td>None</td></tr><tr><td>turms-client-java</td><td>JAR package</td><td>1. Install <a href="https://adoptium.net/temurin/releases" target="_blank" rel="noreferrer">Temurin JDK 21</a><br>2. Install [Maven 3](<a href="https://maven.apache" target="_blank" rel="noreferrer">https://maven.apache</a> .org/download.cgi)<br>3. Execute the command <code>mvn clean install</code> in the root directory of the turms-client-java project</td></tr><tr><td>turms-client-js</td><td>Static resources</td><td>1. Install <a href="https://nodejs.org/en/download" target="_blank" rel="noreferrer">Node.js 18</a><br>2. Execute the command <code>npm under the turms-client-js project i --no-optional &amp;&amp; npm run build</code></td></tr><tr><td>turms-client-swift</td><td>No packaging required</td><td>None</td></tr></tbody></table><h2 id="reference-configuration-of-linux-system" tabindex="-1">Reference Configuration of Linux system <a class="header-anchor" href="#reference-configuration-of-linux-system" aria-label="Permalink to &quot;Reference Configuration of Linux system&quot;">​</a></h2><h3 id="etc-security-limits-conf" tabindex="-1">/etc/security/limits.conf <a class="header-anchor" href="#etc-security-limits-conf" aria-label="Permalink to &quot;/etc/security/limits.conf&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>*        soft    nofile          1048576</span></span>
<span class="line"><span>*        hard    nofile          1048576</span></span></code></pre></div><ul><li><p>nofile is configured as the default maximum value of 1048576 (1024*1024), which is limited by <code>fs.nr_open</code>.</p><p>If users need a larger value, they can use the command <code>sudo sysctl -w fs.nr_open=2147483584</code> to modify the value of <code>fs.nr_open</code>, thereby increasing the upper limit of the maximum value of <code>nofile</code>.</p></li><li><p>The Turms server only needs a few threads to run normally, so the operation and maintenance personnel generally do not need to modify the <code>noproc</code> configuration specifically for the Turms server.</p><p>Regarding why the Turms server only needs a few threads to run normally, readers can read <a href="https://turms-im.github.io/docs/server/module/system-resource-management#%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B" target="_blank" rel="noreferrer">Turms server thread model</a></p></li></ul><p>Reference documents:</p><ul><li><a href="https://www.kernel.org/doc/Documentation/sysctl/fs.txt" target="_blank" rel="noreferrer">https://www.kernel.org/doc/Documentation/sysctl/fs.txt</a></li></ul><h3 id="etc-sysctl-conf" tabindex="-1">/etc/sysctl.conf <a class="header-anchor" href="#etc-sysctl-conf" aria-label="Permalink to &quot;/etc/sysctl.conf&quot;">​</a></h3><p>The default values mentioned in the configuration below are from Ubuntu 20.04 LTS.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span># Default value: 1629424. The total number of file descriptors that can be opened by all processes in the system. A socket needs to occupy a file descriptor</span></span>
<span class="line"><span>fs.file-max = 1629424</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default value: 60. Use swap when the memory usage is less than 10%. Try to avoid using swap to reduce the wake-up soft interrupt process</span></span>
<span class="line"><span>vm.swappiness = 10</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default: 1024. Defines the maximum length of the SYN half-open connection queue. If this parameter is too large, it may intensify the effect of SYN flood attack</span></span>
<span class="line"><span>net.ipv4.tcp_max_syn_backlog = 65536</span></span>
<span class="line"><span># Default: 4096. Adjust the length of the accept queue. You can use the command: netstat -s | grep &quot;listen queue&quot; to see how many connections were dropped due to queue overflow. If there are continuous connections being discarded due to accept queue overflow, the backlog and somaxconn parameters should be increased</span></span>
<span class="line"><span>net.core.somaxconn=65536</span></span>
<span class="line"><span># Default: 1. The SYN Cookie function is enabled only when the SYN semi-connection queue cannot hold a half-open connection. Syncookies can make half-open connections skip the SYN queue and establish connections directly, and can also mitigate SYN flood attacks</span></span>
<span class="line"><span>net.ipv4.tcp_syncookies = 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default: 0. Do not cache metrics for closed TCP connections</span></span>
<span class="line"><span>net.ipv4.tcp_no_metrics_save = 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default value: 15. Control the number of timeout retransmissions of TCP. RFC1122 recommends that the corresponding timeout period should not be less than 100s, that is, at least 8</span></span>
<span class="line"><span>net.ipv4.tcp_retries2 = 10</span></span>
<span class="line"><span># Default value: 6. When acting as a TCP client, the number of times to retry sending SYN to initiate a handshake. It will wait 1, 2, 4 seconds before each retry (7 seconds in total). When communicating in the intranet, the number of retries can be appropriately reduced to expose errors to the application as soon as possible</span></span>
<span class="line"><span>net.ipv4.tcp_syn_retries = 3</span></span>
<span class="line"><span># Default value: 5. When used as a TCP server, the number of retries for SYN+ACK packets. It will wait for 1, 2, 4, 8, 16, and 32 seconds before each retry (a total of 63 seconds is required), and if the last retry still does not receive ACK, the connection will be closed</span></span>
<span class="line"><span>net.ipv4.tcp_synack_retries = 5</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default: 1. Enable selection confirmation, so that TCP only resends lost TCP segments, without sending all unacknowledged TCP segments</span></span>
<span class="line"><span>net.ipv4.tcp_sack = 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default: 0. Set to 0 to drop the connection when the accept queue overflows. The ACK is retransmitted by the TCP client, and the server tries to put the connection into the accept queue again. Discarding the connection can improve the success rate of connection establishment. Only when it is very sure that the accept queue will overflow for a long time can it be set to 1. By sending an RST reset message to the client, the client will be notified as soon as possible that the connection has failed</span></span>
<span class="line"><span>net.ipv4.tcp_abort_on_overflow = 0</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default value: 65536. The maximum number of TCP connections in the system are not associated with any process (when the process calls the close function to close the connection, no matter whether the connection is in the FIN_WAIT1 state or is actually closed), if the number of orphan connections is greater than it, the newly added Orphan connections will no longer wave four times, but will directly send RST reset messages to force close</span></span>
<span class="line"><span>net.ipv4.tcp_max_orphans = 65536</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default: 2. Enable TIME_WAIT reuse, so that new connections can reuse ports in TIME_WAIT state</span></span>
<span class="line"><span>net.ipv4.tcp_tw_reuse = 1</span></span>
<span class="line"><span># Default: 1. In order to make tcp_tw_reuse take effect, the timestamps parameter needs to be set to 1 (tcp_timestamps should also be enabled on the peer). This option provides a more accurate method of calculating the round trip time (Round Trip Time) RTT between the two communicating parties</span></span>
<span class="line"><span>net.ipv4.tcp_timestamps = 1</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default value: 65536. The system maintains the maximum number of TIME_WAIT sockets simultaneously. When the number of TIME_WAIT connections exceeds this parameter, the newly closed connection will no longer experience TIME_WAIT and will be closed directly</span></span>
<span class="line"><span>net.ipv4.tcp_max_tw_buckets = 65536</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default value: 60. Specify how long the TCP connection with the state of FIN_WAIT_2 is kept</span></span>
<span class="line"><span>net.ipv4.tcp_fin_timeout = 30</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Keep the default configuration related to TCP keepalive, because the application layer of Turms has its own set of heartbeat mechanism</span></span>
<span class="line"><span># net.ipv4.tcp_keepalive_probes = ...</span></span>
<span class="line"><span># net.ipv4.tcp_keepalive_intvl = ...</span></span>
<span class="line"><span># net.ipv4.tcp_keepalive_time = ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default value 1. Enable TCP Fast Open, the client can carry the request in the first SYN message to save 1 RTT time</span></span>
<span class="line"><span>net.ipv4.tcp_fastopen = 3</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default value: 1000. When the network card receives data packets faster than the kernel can process them, there will be a backlog to cache these data packets. This parameter represents the maximum value of the queue. When the backlog overflows, the kernel will drop packets</span></span>
<span class="line"><span>net.core.netdev_max_backlog=65536</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Define the maximum value that the receiving window can use, which can be adjusted according to the BDP value</span></span>
<span class="line"><span>net.core.rmem_max = 16777216</span></span>
<span class="line"><span>net.core.wmem_max = 16777216</span></span>
<span class="line"><span></span></span>
<span class="line"><span># [low, pressure, high], the unit is page (4096 bytes)</span></span>
<span class="line"><span># low: When the total used memory of all TCP connections is lower than this value, TCP memory will not be automatically adjusted</span></span>
<span class="line"><span># pressure: When the total used of all TCP connections is greater than pressure, the kernel starts to adjust the buffer size</span></span>
<span class="line"><span># high: When the total used memory of all TCP connections is greater than this value, the kernel will no longer allocate new memory for TCP and will not establish new connections. It should be ensured that the dynamic adjustment upper limit of the buffer reaches the bandwidth-delay product</span></span>
<span class="line"><span># No custom configuration, use the default value automatically calculated by the system</span></span>
<span class="line"><span># net.ipv4.tcp_mem = ...</span></span>
<span class="line"><span></span></span>
<span class="line"><span># [min, default, max], the unit is byte</span></span>
<span class="line"><span># min: Specifies the minimum memory reserved for receiving buffers for each TCP connection. Even in pressure mode, TCP connections will reserve at least this part of memory for receiving buffers</span></span>
<span class="line"><span># default: Specifies the initial memory size of each TCP connection for receiving buffers</span></span>
<span class="line"><span># max: Specifies the maximum memory used for receiving buffers per TCP connection</span></span>
<span class="line"><span># If the buffer is too small, the TCP throughput will be reduced, and the network bandwidth cannot be used efficiently, resulting in increased communication delay; if the buffer is too large, the memory usage of the TCP connection will be high and the bottleneck limited by the bandwidth and delay product will cause memory loss. waste</span></span>
<span class="line"><span>net.ipv4.tcp_rmem = 4096 87380 16777216</span></span>
<span class="line"><span>net.ipv4.tcp_wmem = 4096 87380 16777216</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Default: 1. Enable the adjustment function of the receive buffer</span></span>
<span class="line"><span>net.ipv4.tcp_moderate_rcvbuf = 1</span></span>
<span class="line"><span># Default: 1. TCP uses 16 bits to record the window size, and the maximum value can be 65535B. If this value is exceeded, the tcp_window_scaling mechanism needs to be enabled</span></span>
<span class="line"><span>net.ipv4.tcp_window_scaling = 1</span></span></code></pre></div><p>Once configured, execute <code>sudo sysctl -p</code> to load the latest configuration of sysctl.</p><p>Special mention is: we are in <a href="https://turms-im.github.io/docs/server/module/system-resource-management#%E5%8F%AF%E6%8E%A7%E5%86%85%E5%AD%98-managed-memory-%E7%9A%84%E4%BD%BF%E7%94%A8" target="_blank" rel="noreferrer">system resource management</a> mentioned that the Turms server will reserve part of the memory for the system Kernel, this part of memory mainly refers to the buffer of the above-mentioned TCP connection.</p><h3 id="initial-congestion-window-initcwnd-configuration" tabindex="-1">Initial congestion window (initcwnd) configuration <a class="header-anchor" href="#initial-congestion-window-initcwnd-configuration" aria-label="Permalink to &quot;Initial congestion window (initcwnd) configuration&quot;">​</a></h3><p>Keep the default value: 10MSS.</p><p>Reference documents:</p><ul><li><a href="https://www.kernel.org/doc/Documentation/sysctl/net.txt" target="_blank" rel="noreferrer">https://www.kernel.org/doc/Documentation/sysctl/net.txt</a></li><li><a href="https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt" target="_blank" rel="noreferrer">https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt</a></li></ul></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-d4a0bba5><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-d4a0bba5><span class="visually-hidden" id="doc-footer-aria-label" data-v-d4a0bba5>Pager</span><div class="pager" data-v-d4a0bba5><a class="VPLink link pager-link prev" href="/docs/server/deployment/getting-started.html" data-v-d4a0bba5><!--[--><span class="desc" data-v-d4a0bba5>Previous page</span><span class="title" data-v-d4a0bba5>Build and Start</span><!--]--></a></div><div class="pager" data-v-d4a0bba5><a class="VPLink link pager-link next" href="/docs/server/deployment/config.html" data-v-d4a0bba5><!--[--><span class="desc" data-v-d4a0bba5>Next page</span><span class="title" data-v-d4a0bba5>Configuration</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"feature_simultaneous-login.md\":\"Dv5WDZ3P\",\"client_metrics.md\":\"DgvBnv9p\",\"zh-cn_feature_simultaneous-login.md\":\"Yzt39a3I\",\"client_quick-start.md\":\"Cx9CJs0m\",\"design_status-aware.md\":\"3bmGc5hr\",\"server_module_security.md\":\"CBWTWKsk\",\"zh-cn_server_deployment_distribution.md\":\"DT8RbeaJ\",\"zh-cn_server_module_xmpp.md\":\"DRu0ycXL\",\"zh-cn_server_module_chatbot.md\":\"CFanzC5_\",\"zh-cn_server_module_identity-access-management.md\":\"C5hUtNHe\",\"zh-cn_server_module_data-analytics.md\":\"D6sYc0XT\",\"zh-cn_server_module_observability.md\":\"BDZgjvG6\",\"zh-cn_server_development_code.md\":\"DhvxCHG7\",\"zh-cn_server_module_storage.md\":\"CxdFKvfK\",\"zh-cn_turms-admin.md\":\"CMUtegqM\",\"server_module_anti-spam.md\":\"Ct-j2gvT\",\"feature_message.md\":\"DPG3J4AR\",\"server_module_data-analytics.md\":\"DOIqHdTR\",\"client_session.md\":\"cERMfOfD\",\"server_development_plugin.md\":\"F6ZhUybT\",\"server_development_code.md\":\"xWHpI5qz\",\"feature_group.md\":\"C7OIdEhg\",\"feature_user.md\":\"D4BOVc3K\",\"server_deployment_config.md\":\"Cmn1CbP9\",\"server_module_chatbot.md\":\"Bt9UM6bH\",\"feature_index.md\":\"DIYY6KB5\",\"server_development_testing.md\":\"Bv6zFIhE\",\"client_turms-client-js.md\":\"B-iSLAom\",\"server_development_rules.md\":\"CB4MA8-Z\",\"zh-cn_client_metrics.md\":\"BIMuTxkp\",\"zh-cn_index.md\":\"DPc5b3ha\",\"zh-cn_reference_admin-api.md\":\"De8-D2e6\",\"client_communication-protocol.md\":\"19fqc3rc\",\"server_module_storage.md\":\"COQVIARu\",\"server_module_system-resource-management.md\":\"F-_CQdCl\",\"zh-cn_client_session.md\":\"Dj26WvD7\",\"server_module_xmpp.md\":\"DDfiHQx_\",\"zh-cn_client_quick-start.md\":\"CGHeOh7U\",\"zh-cn_client_requirements.md\":\"CGlXV8Hy\",\"turms-admin.md\":\"9LJIDghC\",\"zh-cn_client_api.md\":\"DEqPhkFh\",\"zh-cn_client_communication-protocol.md\":\"CPUhuAV6\",\"reference_status-code.md\":\"Bf8rzK-V\",\"server_module_observability.md\":\"CsS2LW7_\",\"zh-cn_client_turms-client-js.md\":\"6xpWt-YU\",\"zh-cn_client_turms-chat-demo.md\":\"CVgBfyVl\",\"community_index.md\":\"BDiy7zSc\",\"server_deployment_getting-started.md\":\"CnIQHSBp\",\"zh-cn_community_index.md\":\"BV_rFjnT\",\"zh-cn_server_deployment_getting-started.md\":\"tGsvYK1n\",\"server_deployment_distribution.md\":\"BtNqIqjJ\",\"zh-cn_design_architecture.md\":\"ISY6gZq-\",\"zh-cn_server_development_plugin.md\":\"B3Jr7Kwa\",\"zh-cn_server_development_redevelopment.md\":\"BSaKvZUz\",\"zh-cn_server_module_anti-spam.md\":\"B2XFpQwP\",\"zh-cn_server_development_rules.md\":\"DlKaQigf\",\"zh-cn_server_development_testing.md\":\"Ccj3PX8j\",\"design_architecture.md\":\"C5IK87nB\",\"zh-cn_server_deployment_config.md\":\"2b797jGV\",\"index.md\":\"C5NYzOJd\",\"zh-cn_server_module_system-resource-management.md\":\"BrmFpZkM\",\"reference_admin-api.md\":\"DnI9tYBp\",\"server_development_redevelopment.md\":\"ZOTX-QI7\",\"zh-cn_server_module_cluster.md\":\"BgAb3VQO\",\"zh-cn_server_module_security.md\":\"DC-z9kbp\",\"client_requirements.md\":\"DBzVoZij\",\"zh-cn_feature_index.md\":\"BX4laEtI\",\"zh-cn_feature_group.md\":\"C5OVfQ27\",\"client_api.md\":\"BjNRb0s8\",\"design_schema.md\":\"B-OsSPf2\",\"zh-cn_design_schema.md\":\"_4ZJZ_nW\",\"server_module_cluster.md\":\"DrSh-fmu\",\"zh-cn_reference_status-code.md\":\"Dg8KqdUK\",\"zh-cn_feature_user.md\":\"DR5LmjKU\",\"zh-cn_design_status-aware.md\":\"DZSSltLb\",\"zh-cn_feature_message.md\":\"Dto7crLm\",\"client_turms-chat-demo.md\":\"DHNv3FfS\",\"server_module_identity-access-management.md\":\"KTa7q2p7\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Turms Documentation\",\"description\":\"A VitePress site\",\"base\":\"/docs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"https://raw.githubusercontent.com/turms-im/assets/master/logo/pegion.svg\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/turms-im/turms\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"WV3XO0QV2E\",\"apiKey\":\"f7a7c652875d1f2cc0f0ec52d8f8f660\",\"indexName\":\"turms-imio\",\"locales\":{\"zh-CN\":{\"placeholder\":\"搜索\",\"translations\":{\"button\":{\"buttonText\":\"搜索\",\"buttonAriaLabel\":\"搜索\"},\"modal\":{\"searchBox\":{\"resetButtonTitle\":\"重置查询\",\"resetButtonAriaLabel\":\"重置查询\",\"cancelButtonText\":\"取消\",\"cancelButtonAriaLabel\":\"取消\"},\"startScreen\":{\"recentSearchesTitle\":\"搜索历史\",\"noRecentSearchesText\":\"没有搜索历史\",\"saveRecentSearchButtonTitle\":\"保存至搜索历史\",\"removeRecentSearchButtonTitle\":\"从搜索历史中移除\",\"favoriteSearchesTitle\":\"收藏\",\"removeFavoriteSearchButtonTitle\":\"从收藏中移除\"},\"errorScreen\":{\"titleText\":\"无法获取搜索结果\",\"helpText\":\"请检查网络连接\"},\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\",\"closeText\":\"关闭\",\"searchByText\":\"搜索提供者\"},\"noResultsScreen\":{\"noResultsText\":\"没有找到相关结果\",\"suggestedQueryText\":\"您可能想搜索\",\"reportMissingResultsLinkText\":\"点击反馈\",\"reportMissingResultsText\":\"没有找到结果？请报告缺失\"}}}}}}}},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\",\"themeConfig\":{\"sidebar\":[{\"text\":\"Introduction\",\"link\":\"/index.md\"},{\"text\":\"Community FAQ\",\"link\":\"/community/index.md\"},{\"text\":\"Business Features\",\"collapsed\":true,\"items\":[{\"text\":\"Business Features\",\"link\":\"/feature/index.md\"},{\"text\":\"Simultaneous Login\",\"link\":\"/feature/simultaneous-login.md\"},{\"text\":\"User-related Features\",\"link\":\"/feature/user.md\"},{\"text\":\"Group-related Features\",\"link\":\"/feature/group.md\"},{\"text\":\"Message-related Features\",\"link\":\"/feature/message.md\"}]},{\"text\":\"Design\",\"collapsed\":true,\"items\":[{\"text\":\"Architecture Design\",\"link\":\"/design/architecture.md\"},{\"text\":\"Collection Schema Design\",\"link\":\"/design/schema.md\"},{\"text\":\"Status Awareness\",\"link\":\"/design/status-aware.md\"}]},{\"text\":\"Server Guide\",\"collapsed\":true,\"items\":[{\"text\":\"Deployment\",\"items\":[{\"text\":\"Build and Start\",\"link\":\"/server/deployment/getting-started.md\"},{\"text\":\"Distribution\",\"link\":\"/server/deployment/distribution.md\"},{\"text\":\"Configuration\",\"link\":\"/server/deployment/config.md\"}]},{\"text\":\"Development\",\"items\":[{\"text\":\"About Secondary Development\",\"link\":\"/server/development/redevelopment.md\"},{\"text\":\"Basic Development Rules\",\"link\":\"/server/development/rules.md\"},{\"text\":\"Custom Plugins\",\"link\":\"/server/development/plugin.md\"},{\"text\":\"Source Code\",\"link\":\"/server/development/code.md\"},{\"text\":\"Testing\",\"link\":\"/server/development/testing.md\"}]},{\"text\":\"Main Modules\",\"items\":[{\"text\":\"Identity and Access Management\",\"link\":\"/server/module/identity-access-management.md\"},{\"text\":\"Cluster Design and Implementation\",\"link\":\"/server/module/cluster.md\"},{\"text\":\"System Resource Management\",\"link\":\"/server/module/system-resource-management.md\"},{\"text\":\"Observability\",\"link\":\"/server/module/observability.md\"},{\"text\":\"Security\",\"link\":\"/server/module/security.md\"},{\"text\":\"XMPP\",\"link\":\"/server/module/xmpp.md\"},{\"text\":\"Storage Service\",\"link\":\"/server/module/storage.md\"},{\"text\":\"Chatbot\",\"link\":\"/server/module/chatbot.md\"},{\"text\":\"Content Moderation\",\"link\":\"/server/module/anti-spam.md\"},{\"text\":\"Data Analysis\",\"link\":\"/server/module/data-analytics.md\"}]}]},{\"text\":\"Client Guide\",\"collapsed\":true,\"items\":[{\"text\":\"Quick Start\",\"link\":\"/client/quick-start.md\"},{\"text\":\"Version Requirements\",\"link\":\"/client/requirements.md\"},{\"text\":\"API\",\"link\":\"/client/api.md\"},{\"text\":\"Session Lifecycle\",\"link\":\"/client/session.md\"},{\"text\":\"Metrics\",\"link\":\"/client/metrics.md\"},{\"text\":\"Communication Protocol Used Between Client and Server\",\"link\":\"/client/communication-protocol.md\"},{\"text\":\"turms-client-js Shared Context\",\"link\":\"/client/turms-client-js.md\"},{\"text\":\"Turms Chat Demo\",\"link\":\"/client/turms-chat-demo.md\"}]},{\"text\":\"turms-admin\",\"link\":\"/turms-admin.md\"},{\"text\":\"Reference\",\"collapsed\":true,\"items\":[{\"text\":\"Admin API\",\"link\":\"/reference/admin-api.md\"},{\"text\":\"Status Code\",\"link\":\"/reference/status-code.md\"}]}]}},\"zh-CN\":{\"label\":\"简体中文\",\"lang\":\"zh-CN\",\"themeConfig\":{\"lastUpdatedText\":\"上次更新\",\"outline\":{\"label\":\"当前页\"},\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"sidebar\":[{\"text\":\"介绍\",\"link\":\"/zh-CN/index.md\"},{\"text\":\"社区常见问题\",\"link\":\"/zh-CN/community/index.md\"},{\"text\":\"业务功能\",\"collapsed\":true,\"items\":[{\"text\":\"业务功能介绍\",\"link\":\"/zh-CN/feature/index.md\"},{\"text\":\"多端登录\",\"link\":\"/zh-CN/feature/simultaneous-login.md\"},{\"text\":\"用户相关功能\",\"link\":\"/zh-CN/feature/user.md\"},{\"text\":\"群组相关功能\",\"link\":\"/zh-CN/feature/group.md\"},{\"text\":\"消息相关功能\",\"link\":\"/zh-CN/feature/message.md\"}]},{\"text\":\"设计\",\"collapsed\":true,\"items\":[{\"text\":\"架构设计\",\"link\":\"/zh-CN/design/architecture.md\"},{\"text\":\"集合结构设计\",\"link\":\"/zh-CN/design/schema.md\"},{\"text\":\"状态感知\",\"link\":\"/zh-CN/design/status-aware.md\"}]},{\"text\":\"服务端指南\",\"collapsed\":true,\"items\":[{\"text\":\"部署\",\"items\":[{\"text\":\"搭建与启动\",\"link\":\"/zh-CN/server/deployment/getting-started.md\"},{\"text\":\"发布\",\"link\":\"/zh-CN/server/deployment/distribution.md\"},{\"text\":\"配置参数\",\"link\":\"/zh-CN/server/deployment/config.md\"}]},{\"text\":\"开发\",\"items\":[{\"text\":\"关于二次开发\",\"link\":\"/zh-CN/server/development/redevelopment.md\"},{\"text\":\"基本开发规约\",\"link\":\"/zh-CN/server/development/rules.md\"},{\"text\":\"自定义插件\",\"link\":\"/zh-CN/server/development/plugin.md\"},{\"text\":\"源码\",\"link\":\"/zh-CN/server/development/code.md\"},{\"text\":\"测试\",\"link\":\"/zh-CN/server/development/testing.md\"}]},{\"text\":\"主要模块\",\"items\":[{\"text\":\"身份与访问管理\",\"link\":\"/zh-CN/server/module/identity-access-management.md\"},{\"text\":\"集群的设计与实现\",\"link\":\"/zh-CN/server/module/cluster.md\"},{\"text\":\"系统资源管理\",\"link\":\"/zh-CN/server/module/system-resource-management.md\"},{\"text\":\"可观测性体系\",\"link\":\"/zh-CN/server/module/observability.md\"},{\"text\":\"安全\",\"link\":\"/zh-CN/server/module/security.md\"},{\"text\":\"XMPP\",\"link\":\"/zh-CN/server/module/xmpp.md\"},{\"text\":\"存储服务\",\"link\":\"/zh-CN/server/module/storage.md\"},{\"text\":\"聊天机器人\",\"link\":\"/zh-CN/server/module/chatbot.md\"},{\"text\":\"敏感词过滤\",\"link\":\"/zh-CN/server/module/anti-spam.md\"},{\"text\":\"数据分析\",\"link\":\"/zh-CN/server/module/data-analytics.md\"}]}]},{\"text\":\"客户端指南\",\"collapsed\":true,\"items\":[{\"text\":\"Quick Start\",\"link\":\"/zh-CN/client/quick-start.md\"},{\"text\":\"版本要求\",\"link\":\"/zh-CN/client/requirements.md\"},{\"text\":\"接口\",\"link\":\"/zh-CN/client/api.md\"},{\"text\":\"会话的生命周期\",\"link\":\"/zh-CN/client/session.md\"},{\"text\":\"度量数据\",\"link\":\"/zh-CN/client/metrics.md\"},{\"text\":\"与服务端通信时使用的数据格式\",\"link\":\"/zh-CN/client/communication-protocol.md\"},{\"text\":\"turms-client-js共享上下文\",\"link\":\"/zh-CN/client/turms-client-js.md\"},{\"text\":\"Turms Chat Demo\",\"link\":\"/zh-CN/client/turms-chat-demo.md\"}]},{\"text\":\"turms-admin\",\"link\":\"/zh-CN/turms-admin.md\"},{\"text\":\"手册\",\"collapsed\":true,\"items\":[{\"text\":\"管理员API接口\",\"link\":\"/zh-CN/reference/admin-api.md\"},{\"text\":\"状态码\",\"link\":\"/zh-CN/reference/status-code.md\"}]}]}}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>