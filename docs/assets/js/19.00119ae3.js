(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{379:function(s,t,a){"use strict";a.r(t);var r=a(24),n=Object(r.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"quick-start"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#quick-start"}},[s._v("#")]),s._v(" Quick Start")]),s._v(" "),a("p",[s._v("若您网络畅通，第一次完成以下全部操作大概需要花费10~30分钟。当您熟练之后，可在1~3分钟完成各种集群的部署工作。")]),s._v(" "),a("h2",{attrs:{id:"步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("MongoDB集群搭建（用于业务数据存储、服务发现、配置管理）")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("下载并安装"),a("a",{attrs:{href:"https://www.mongodb.com/download-center/community",target:"_blank",rel:"noopener noreferrer"}},[s._v("MongoDB"),a("OutboundLink")],1),s._v("（要求最低版本号为：4.0。推荐版本为最新稳定版）。以RHEL/CentOS为例（具体可参考：https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat）：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF"),a("span",{pre:!0,attrs:{class:"token bash punctuation"}},[s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/yum.repos.d/mongodb-org-4.4.repo")]),s._v("\n[mongodb-org-4.4]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$releasever")]),s._v("/mongodb-org/4.4/x86_64/\ngpgcheck=1\nenabled=1\ngpgkey=https://www.mongodb.org/static/pgp/server-4.4.asc\nEOF")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y mongodb-org\n")])])])]),s._v(" "),a("li",[a("p",[s._v("搭建MongoDB服务端集群（以mlaunch为例。关于mlaunch提供的更多指令，请查阅：http://blog.rueckstiess.com/mtools/mlaunch.html）。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("pip3 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mtools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mlaunch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmlaunch init --replicaset --sharded "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" --nodes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" --config "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" --hostname localhost --port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29510")]),s._v(" --mongos "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),a("p",[s._v("请确保运行正常，否则Turms会抛出MongoSocketOpenException异常。")])])])]),s._v(" "),a("li",[a("p",[s._v("下载、安装并启动Redis服务端（用于实现用户状态管理、“附近的用户”，以及turms-client-js服务降级中登录失败与会话失联原因的查询）。以RHEL/CentOS为例：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" epel-release\nyum update\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" redis\nsystemctl start redis\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" redis\n")])])]),a("p",[s._v("对于Windows平台，可在 "),a("a",{attrs:{href:"https://github.com/tporadowski/redis/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("tporadowski/redis"),a("OutboundLink")],1),s._v(" 下载Windows版本供本地开发测试用。")])]),s._v(" "),a("li",[a("p",[s._v("Turms集群搭建（以下为手动搭建方案，之后会提供turms-cli做自动化集群部署）")]),s._v(" "),a("p",[s._v("方案一：拉取Turms服务端Docker镜像，并运行：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Pull images")]),s._v("\ndocker pull ghcr.io/turms-im/turms-admin\ndocker pull ghcr.io/turms-im/turms\ndocker pull ghcr.io/turms-im/turms-gateway\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Run images")]),s._v("\ndocker run -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6510")]),s._v(":6510 ghcr.io/turms-im/turms-admin\ndocker run -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7510")]),s._v(":7510 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8510")]),s._v(":8510 ghcr.io/turms-im/turms\ndocker run --ulimit "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nofile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("102400")]),s._v(":102400 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7510")]),s._v(":7510 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9510")]),s._v(":9510 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10510")]),s._v(":10510 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11510")]),s._v(":11510 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12510")]),s._v(":12510 ghcr.io/turms-im/turms-gateway\n")])])]),a("p",[s._v("另外，您可以通过volume挂载的方式来使用自定义的application.yaml与jvm.options配置“-v /your-custom-config-dir:/opt/turms/turms/config”。")]),s._v(" "),a("p",[s._v("方案二："),a("s",[s._v("下载并解压"),a("a",{attrs:{href:"https://github.com/turms-im/turms/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("Turms服务端"),a("OutboundLink")],1),s._v("压缩包")]),s._v("（由于v.0.10.0尚未发布在release页面中，因此该方案暂不可用），根据下述步骤运行：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("（如果您将MongoDB与Redis都安装默认配置安装在本地，可跳过此步骤）根据您的需求配置config/jvm.options、config/application.yaml（您可以在此处配置Turms自定义的配置参数，并且您也可以在此处配置多个MongoDB或mongos的服务端地址。具体可参考：https://docs.mongodb.com/manual/reference/connection-string）。")])]),s._v(" "),a("li",[a("p",[s._v("（推荐使用Ansible）在所有需要运行Turms服务端的系统上，运行bin/turms脚本（默认以Thin包形式执行，若需以Fat包形式执行，请在执行脚本时加上“-f”参数，如：“sh turms.sh -f”。之后再运行turms-gateway服务端。turms与turms-gateway服务端会通过MongoDB（作为服务注册中心）来自动寻找其他服务端节点，由此Turms集群开始运作。")])])]),s._v(" "),a("p",[s._v("方案三：克隆Turms仓库源码，直接通过IDE运行turms与turms-gateway服务端。（参考命令：git clone --depth 1 https://github.com/turms-im/turms.git）")])])]),s._v(" "),a("p",[a("strong",[s._v("提醒")])]),s._v(" "),a("ul",[a("li",[s._v("turms服务端在启动时，会自动检测数据库中是否已存在一个角色为“ROOT”，且账号为“turms”的超级管理员账号。如果不存在，则turms服务端会自动创建一个角色为“ROOT”、名称与密码均为“turms”的管理员账号。在生产环境中，请务必记得要修改默认密码。")]),s._v(" "),a("li",[s._v("上述操作主要用于您初次体验Turms集群使用，若您需将Turms部署在生产环境当中，请务必查阅Wiki手册，了解各种配置参数的意义，以最小的资源消耗，来定制属于您自己的业务需求与业务组合。")])])])}),[],!1,null,null,null);t.default=n.exports}}]);